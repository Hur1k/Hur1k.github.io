<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="x5-fullscreen" content="true">
<meta name="full-screen" content="yes">
<meta name="theme-color" content="#317EFB" />
<meta content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=0" name="viewport">
<meta name="description" content="Á¨¨‰∏ÄÁØáWP (‚ïπ⁄°‚ïπ ) ‰ªéÂÜ≥ËµõÂà∞Áé∞Âú®Â§ßÊ¶ÇÊòØ2Âë®ÁöÑÊó∂Èó¥,Áªà‰∫éÁÆóÊòØÂÅöÂÆå‰∫Üüò≠ GhidraÁ´üÁÑ∂ËÉΩÊâìÂºÄ!!ËôΩÁÑ∂ÂèçÁºñËØëÂ±Ç‰πüÊòØÊúâÁÇπÈöæ,ÂÅöÂÆåÂêéÂèëÁé∞ÂÖ∂ÂÆûÂä†ÂØÜÊìç‰Ωú‰∏çÁÆóÈöæ,Âè™ÊòØÊû∂ÊûÑÈóÆÈ¢òÊääÂæàÂ§öÊìç‰ΩúÈÉΩÂ§çÊùÇÂåñ‰∫Ü ËôΩÁÑ∂Ëä±ÁöÑÊó∂Èó¥ÊØîËæÉ‰πÖ,‰ΩÜÊÄªÁöÑÊù•ËØ¥Êî∂Ëé∑ËøòÊòØÊå∫Â§ßÁöÑ,‰ª•Ââç‰∏ÄÁõ¥‰æùËµñÁùÄË¥µÂ¶áÂ§¥ÁöÑÂä®Ë∞ÉÂ∑•ÂÖ∑,ÂæàÂ∞ëÁî®Âà∞Âè™ÊúâÂèçÊ±áÁºñÊ≤°ÊúâÂèçÁºñËØëÁöÑÂ∑•ÂÖ∑Â¶Çgdb(gdbÈÉΩ‰∏ç‰ºöÁî®!ËØ•Êâì!),Âè¶Â§ñ‰πüÁªÉ‰π†‰∫Ü‰∏Ä‰∏ãÁü©ÈòµÁ±ªÁöÑÈ¢òÁõÆ,Áõ∏ÂÖ≥Â∫ì(numpy,sympy)">
<meta property="og:type" content="article">
<meta property="og:title" content="XSCTFÂÜ≥Ëµõ-Èò≤AK-writeup">
<meta property="og:url" content="http://example.com/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/index.html">
<meta property="og:site_name" content="(ÊñΩÂ∑•‰∏≠...Èó≤‰∫∫ÂÖçËøõ...)Hur1kÁöÑÂ∞èÂ∞èÁ™ù( ‚Ä¢ÃÄ œâ ‚Ä¢ÃÅ )‚úß">
<meta property="og:description" content="Á¨¨‰∏ÄÁØáWP (‚ïπ⁄°‚ïπ ) ‰ªéÂÜ≥ËµõÂà∞Áé∞Âú®Â§ßÊ¶ÇÊòØ2Âë®ÁöÑÊó∂Èó¥,Áªà‰∫éÁÆóÊòØÂÅöÂÆå‰∫Üüò≠ GhidraÁ´üÁÑ∂ËÉΩÊâìÂºÄ!!ËôΩÁÑ∂ÂèçÁºñËØëÂ±Ç‰πüÊòØÊúâÁÇπÈöæ,ÂÅöÂÆåÂêéÂèëÁé∞ÂÖ∂ÂÆûÂä†ÂØÜÊìç‰Ωú‰∏çÁÆóÈöæ,Âè™ÊòØÊû∂ÊûÑÈóÆÈ¢òÊääÂæàÂ§öÊìç‰ΩúÈÉΩÂ§çÊùÇÂåñ‰∫Ü ËôΩÁÑ∂Ëä±ÁöÑÊó∂Èó¥ÊØîËæÉ‰πÖ,‰ΩÜÊÄªÁöÑÊù•ËØ¥Êî∂Ëé∑ËøòÊòØÊå∫Â§ßÁöÑ,‰ª•Ââç‰∏ÄÁõ¥‰æùËµñÁùÄË¥µÂ¶áÂ§¥ÁöÑÂä®Ë∞ÉÂ∑•ÂÖ∑,ÂæàÂ∞ëÁî®Âà∞Âè™ÊúâÂèçÊ±áÁºñÊ≤°ÊúâÂèçÁºñËØëÁöÑÂ∑•ÂÖ∑Â¶Çgdb(gdbÈÉΩ‰∏ç‰ºöÁî®!ËØ•Êâì!),Âè¶Â§ñ‰πüÁªÉ‰π†‰∫Ü‰∏Ä‰∏ãÁü©ÈòµÁ±ªÁöÑÈ¢òÁõÆ,Áõ∏ÂÖ≥Â∫ì(numpy,sympy)">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/1.png">
<meta property="og:image" content="http://example.com/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/2.png">
<meta property="og:image" content="http://example.com/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/3.png">
<meta property="og:image" content="http://example.com/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/4.png">
<meta property="og:image" content="http://example.com/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/5.png">
<meta property="og:image" content="http://example.com/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/6.png">
<meta property="article:published_time" content="2022-11-18T16:47:44.000Z">
<meta property="article:modified_time" content="2022-11-27T11:56:31.780Z">
<meta property="article:author" content="Hur1k">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/1.png">


<title >XSCTFÂÜ≥Ëµõ-Èò≤AK-writeup</title>

<!-- Favicon -->

    <link href='/img/favicon.svg?v=0.0.0' rel='icon' type='image/png' sizes='16x16' ></link>


    <link href='/img/favicon.svg?v=0.0.0' rel='icon' type='image/png' sizes='32x32' ></link>




<!-- Plugin -->




    
<link rel="stylesheet" href="/css/plugins/bootstrap.row.css">

    
<link rel="stylesheet" href="https://unpkg.com/locomotive-scroll@4.1.4/dist/locomotive-scroll.min.css">

    
<link rel="stylesheet" href="https://unpkg.com/@fancyapps/ui@4.0/dist/fancybox.css">


    

    



<!-- Icon -->

    
<link rel="stylesheet" href="/css/plugins/font-awesome.min.css">




<!-- Variable -->
<script>window.ASYNC_CONFIG = {"hostname":"example.com","author":"Hur1k","root":"/","typed_text":"hahahahhahahahaharik","favicon":{"logo":"/img/favicon.svg","icon16":"/img/favicon.svg","icon32":"/img/favicon.svg","appleTouchIcon":null,"webmanifest":null,"visibilitychange":true,"hidden":"/failure.ico","showText":"(/‚âß‚ñΩ‚â¶/)Âí¶ÔºÅÂèàÂ•Ω‰∫ÜÔºÅ","hideText":"404 Error"},"theme_version":"0.0.0","theme":{"switch":true,"default":"style-light"},"search":{"enable":true,"type":"engine","href":"https://www.google.com/search?q=site:","domain":null},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms","author":"Post author: ","copyright_link":"Post link: ","copyright_license_title":"Copyright Notice: ","copyright_license_content":"All articles in this blog are licensed under undefined unless otherwise stated.","copy_button":"Copy","copy_success":"Copied","copy_failure":"Copy failed","open_read_mode":"Enter reading mode","exit_read_mode":"Exit reading mode"},"creative_commons":{"license":"by-nc-sa","language":"deed.zh","post":false,"clipboard":false},"swup":false,"plugin":{"flickr_justified_gallery":{"js":"https://unpkg.com/flickr-justified-gallery@latest/dist/fjGallery.min.js"},"fancybox":{"css":"https://unpkg.com/@fancyapps/ui@4.0/dist/fancybox.css","js":"https://unpkg.com/@fancyapps/ui@4.0/dist/fancybox.umd.js"}},"icons":{"sun":"far fa-sun","moon":"far fa-moon","play":"fas fa-play","email":"far fa-envelope","next":"fas fa-arrow-right","calendar":"far fa-calendar-alt","clock":"fas fa-yin-yang","user":"fas fa-user-secret","back_top":"fas fa-arrow-up","close":"fas fa-times","search":"fas fa-search","reward":"fas fa-hand-holding-usd","user_tag":"fas fa-user-alt","toc_tag":"fas fa-th-list","read":"fas fa-book-reader","arrows":"fas fa-arrows-alt-h"}};</script>

<!-- Theme mode css -->
<link data-swup-theme rel="stylesheet" href="/css/index.css?v=0.0.0" id="trm-switch-style">
<script>
    let defaultMode = ASYNC_CONFIG.theme.default !=='auto' ?  ASYNC_CONFIG.theme.default : (window.matchMedia("(prefers-color-scheme: light)").matches ? 'style-light' : 'style-dark')
    let catchMode = localStorage.getItem('theme-mode') || defaultMode;
    let type = catchMode === 'style-dark' ? 'add' : 'remove';
    document.documentElement.classList[type]('dark')
</script>

<!-- CDN -->


    

    



<!-- Site Analytics -->
 
<meta name="generator" content="Hexo 6.3.0"></head>

<body>

  <!-- app wrapper -->
  <div class="trm-app-frame">

    <!-- page preloader -->
    <div class="trm-preloader">
    <div class="trm-holder">
        <div class="preloader">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
</div>
    <!-- page preloader end -->

    <!-- change mode preloader -->
    <div class="trm-mode-swich-animation-frame">
    <div class="trm-mode-swich-animation">
        <i class="i-sun"><i class="iconfont far fa-sun"></i></i>
        <div class="trm-horizon"></div>
        <i class="i-moon"><i class="iconfont far fa-moon"></i></i>
    </div>
</div>
    <!-- change mode preloader end -->

      <!-- scroll container -->
      <div id="trm-dynamic-content" class="trm-swup-animation">
        <div id="trm-scroll-container" class="trm-scroll-container" data-scroll-container style="opacity: 0">
          <div data-scroll-section id="content" class="trm-scroll-section">

            <div class="locomotive-scroll__sticky-target" style=" position: absolute; top: 0; left: 0; right: 0; bottom: 0; pointer-events: none;"></div>

            <!-- top bar -->
            <header class="trm-top-bar" data-scroll data-scroll-sticky data-scroll-target=".locomotive-scroll__sticky-target" data-scroll-offset="-10">
	<div class="container">
		<div class="trm-left-side">
			<!-- logo -->
			<a href="/" class="trm-logo-frame trm-anima-link">
				
					<img alt="logo" src="/img/favicon.svg">
				
				
			</a>
			<!-- logo end -->
		</div>
		<div class="trm-right-side">

			<!-- menu -->
			<div class="trm-menu">
				<nav>
					<ul>
						
						<li class="menu-item-has-children ">
							<a  href="/" target="">
								Home
							</a>
							
						</li>
						
						<li class="menu-item-has-children ">
							<a  href="/archives/" target="">
								Archives
							</a>
							
						</li>
						
						<li class="menu-item-has-children ">
							<a  href="/about/" target="">
								About
							</a>
							
						</li>
						
						<li class="menu-item-has-children ">
							<a  href="/link/" target="">
								menu.link
							</a>
							
						</li>
						
					</ul>
				</nav>
			</div>
			<!-- menu end -->
			
			<!-- mode switcher place -->
			
			<div class="trm-mode-switcher-place">
				<!-- <div class="trm-hidden-switcher"> -->
					<div class="trm-mode-switcher">
					  <i class="iconfont far fa-sun"></i>
					  <input class="tgl tgl-light" id="trm-swich" type="checkbox">
					  <label class="trm-swich" for="trm-swich"></label>
					  <i class="iconfont far fa-moon"></i>
					</div>
				  <!-- </div> -->
			</div>
			
			<!-- mode switcher place end -->

			
				
					<a id="trm-search-btn" class="trm-search-btn" data-no-swup target="_blank" href="https://www.google.com/search?q=site:null">
						<i class="iconfont fas fa-search"></i>
					</a>
				 
			 

		</div>
		<div class="trm-menu-btn">
			<span></span>
		</div>
	</div>
</header>
            <!-- top bar end -->

            <!-- body -->
            
<div class="trm-content-start">
    <!-- banner -->
    <div class="trm-banner" data-scroll data-scroll-direction="vertical">
    
    <!-- banner cover -->
    <img style="object-position:top;object-fit:cover;" alt="banner" class="trm-banner-cover" data-scroll data-scroll-direction="vertical" data-scroll-speed="-3" src="/img/banner.png">
    <!-- banner cover end -->
    

    <!-- banner content -->
    <div class="trm-banner-content trm-overlay">
        <div class="container" data-scroll data-scroll-direction="vertical" data-scroll-speed="0">
            <div class="row">
                
                <div class="col-lg-4"></div>
                
                <div class="col-lg-8">

                    <!-- banner title -->
                    <div class="trm-banner-text ">
                        <div class="trm-label trm-mb-20">
                            NEWS LETTER
                        </div>
                        <h1 class="trm-mb-30 trm-hsmb-font">
                            XSCTFÂÜ≥Ëµõ-Èò≤AK-writeup
                        </h1>

                        
                            <ul class="trm-breadcrumbs trm-label">
                                <li>
                                    <a href="/" class="trm-anima-link">Home</a>
                                </li>
                                <li>
                                    <span>
                                        2022
                                    </span
                                ></li>
                            </ul>
                        
                    </div>
                    <!-- banner title end -->

                    <!-- scroll hint -->
                    <a href="#about-triger" data-scroll-to="#about-triger" data-scroll-offset="-130" class="trm-scroll-hint-frame">
                        <div class="trm-scroll-hint"></div>
                        <span class="trm-label">Scroll down</span>
                    </a>
                    <!-- scroll hint end -->

                </div>
            </div>
        </div>
    </div>
    <!-- banner content end -->
</div>
    <!-- banner end -->
    <div class="container">
        <div class="row">
            
                <div id="page-sidebar" class="col-lg-4 hidden-sm">
                    <!-- main card -->
                    

<div class="trm-main-card-frame trm-sidebar">
    <div class="trm-main-card" data-scroll data-scroll-repeat data-scroll-sticky data-scroll-target=".locomotive-scroll__sticky-target" data-scroll-offset="60"> 
    
        <div class="trm-user-tabs" id="sidebar-tabs">
           <div class="trm-tabs-nav trm-mb-40" id="trm-tabs-nav">
                <div data-to="tabs-user" class="trm-tabs-nav-item">
                    <i class="iconfont fas fa-user-alt"></i>
                </div>
                <div data-to="tabs-toc" class="trm-tabs-nav-item active">
                    <i class="iconfont fas fa-th-list"></i>
                </div>
           </div>
            <div name="tabs-user" class="trm-tabs-item">
                <!-- card header -->
<div class="trm-mc-header">
    <div class="trm-avatar-frame trm-mb-20">
        <img alt="Avatar" class="trm-avatar" src="/img/avatar.jpg">
    </div>
    <h5 class="trm-name trm-mb-15">
        Hur1k
    </h5>
    
</div>
<!-- card header end -->

<!-- sidebar social -->
<div class="trm-divider trm-mb-40 trm-mt-40"></div>

<div class="trm-social">
    
        <a href="https://github.com" title="Github" rel="nofollow" target="_blank">
            <i class="iconfont fab fa-github"></i>
        </a>
    
</div>

<!-- sidebar social end -->

<!-- info -->
<div class="trm-divider trm-mb-40 trm-mt-40"></div>
<ul class="trm-table trm-mb-20">
    
        <li>
            <div class="trm-label">
                Residence:
            </div>
            <div class="trm-label trm-label-light">
                Mars
            </div>
        </li>
    
</ul>

            </div>
            <div name="tabs-toc" class="trm-tabs-item active">
                <div class="post-toc">
    <ol class="toc"><li class="toc-item toc-level-1"><a rel="nofollow" class="toc-link" href="#exp"  data-scroll-to="#exp"><span class="toc-text">exp</span></a></li><li class="toc-item toc-level-1"><a rel="nofollow" class="toc-link" href="#ÁúÅÊµÅ"  data-scroll-to="#ÁúÅÊµÅ"><span class="toc-text">ÁúÅÊµÅ</span></a></li><li class="toc-item toc-level-1"><a rel="nofollow" class="toc-link" href="#‰∏Ä‰∫õÁßØÁ¥Ø"  data-scroll-to="#‰∏Ä‰∫õÁßØÁ¥Ø"><span class="toc-text">‰∏Ä‰∫õÁßØÁ¥Ø</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#RiscvÂØÑÂ≠òÂô®"  data-scroll-to="#RiscvÂØÑÂ≠òÂô®"><span class="toc-text">RiscvÂØÑÂ≠òÂô®</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a rel="nofollow" class="toc-link" href="#ËøêË°å-Âä®Ë∞É"  data-scroll-to="#ËøêË°å-Âä®Ë∞É"><span class="toc-text">ËøêË°å+Âä®Ë∞É</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a rel="nofollow" class="toc-link" href="#Áõ∏ÂÖ≥Â∑•ÂÖ∑"  data-scroll-to="#Áõ∏ÂÖ≥Â∑•ÂÖ∑"><span class="toc-text">Áõ∏ÂÖ≥Â∑•ÂÖ∑</span></a></li><li class="toc-item toc-level-2"><a rel="nofollow" class="toc-link" href="#ÈùôÊÄÅÈìæÊé•ËøêË°å"  data-scroll-to="#ÈùôÊÄÅÈìæÊé•ËøêË°å"><span class="toc-text">ÈùôÊÄÅÈìæÊé•ËøêË°å</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#ÊñπÊ≥ï1"  data-scroll-to="#ÊñπÊ≥ï1"><span class="toc-text">ÊñπÊ≥ï1</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#ÊñπÊ≥ï2-ÂèÇËÄÉ"  data-scroll-to="#ÊñπÊ≥ï2-ÂèÇËÄÉ"><span class="toc-text">ÊñπÊ≥ï2(ÂèÇËÄÉ)</span></a></li></ol></li><li class="toc-item toc-level-2"><a rel="nofollow" class="toc-link" href="#Âä®ÊÄÅÈìæÊé•ËøêË°å-ËøòÊ≤°ËØïËøá"  data-scroll-to="#Âä®ÊÄÅÈìæÊé•ËøêË°å-ËøòÊ≤°ËØïËøá"><span class="toc-text">Âä®ÊÄÅÈìæÊé•ËøêË°å(ËøòÊ≤°ËØïËøá)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#ÂÆâË£ÖÂÖ±‰∫´Â∫ì-ÂèÇËÄÉ"  data-scroll-to="#ÂÆâË£ÖÂÖ±‰∫´Â∫ì-ÂèÇËÄÉ"><span class="toc-text">ÂÆâË£ÖÂÖ±‰∫´Â∫ì(ÂèÇËÄÉ)</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#ÊåáÂÆöÂÖ±‰∫´Â∫ì"  data-scroll-to="#ÊåáÂÆöÂÖ±‰∫´Â∫ì"><span class="toc-text">ÊåáÂÆöÂÖ±‰∫´Â∫ì</span></a></li></ol></li><li class="toc-item toc-level-2"><a rel="nofollow" class="toc-link" href="#Âä®ÊÄÅË∞ÉËØï"  data-scroll-to="#Âä®ÊÄÅË∞ÉËØï"><span class="toc-text">Âä®ÊÄÅË∞ÉËØï</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#Â∞ùËØï‰∏Ä"  data-scroll-to="#Â∞ùËØï‰∏Ä"><span class="toc-text">Â∞ùËØï‰∏Ä</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#Â∞ùËØï‰∫å"  data-scroll-to="#Â∞ùËØï‰∫å"><span class="toc-text">Â∞ùËØï‰∫å</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a rel="nofollow" class="toc-link" href="#Hacking1-ÊúâÈôêÂüüÁü©Èòµ‰πòÊ≥ï"  data-scroll-to="#Hacking1-ÊúâÈôêÂüüÁü©Èòµ‰πòÊ≥ï"><span class="toc-text">Hacking1-ÊúâÈôêÂüüÁü©Èòµ‰πòÊ≥ï</span></a></li><li class="toc-item toc-level-1"><a rel="nofollow" class="toc-link" href="#Hacking2-Â§çÂà∂"  data-scroll-to="#Hacking2-Â§çÂà∂"><span class="toc-text">Hacking2-Â§çÂà∂</span></a></li><li class="toc-item toc-level-1"><a rel="nofollow" class="toc-link" href="#Hacking3-base64È≠îÊîπ"  data-scroll-to="#Hacking3-base64È≠îÊîπ"><span class="toc-text">Hacking3-base64È≠îÊîπ</span></a></li><li class="toc-item toc-level-1"><a rel="nofollow" class="toc-link" href="#EXP"  data-scroll-to="#EXP"><span class="toc-text">EXP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#ÁàÜÁ†¥Áü©Èòµ"  data-scroll-to="#ÁàÜÁ†¥Áü©Èòµ"><span class="toc-text">ÁàÜÁ†¥Áü©Èòµ</span></a></li><li class="toc-item toc-level-3"><a rel="nofollow" class="toc-link" href="#Ê≠£ËßÑÂÜõÂÅöÊ≥ï"  data-scroll-to="#Ê≠£ËßÑÂÜõÂÅöÊ≥ï"><span class="toc-text">Ê≠£ËßÑÂÜõÂÅöÊ≥ï</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a rel="nofollow" class="toc-link" href="#Getflag"  data-scroll-to="#Getflag"><span class="toc-text">Getflag</span></a></li><li class="toc-item toc-level-1"><a rel="nofollow" class="toc-link" href="#‰∏Ä‰∫õÂ§áÂøò"  data-scroll-to="#‰∏Ä‰∫õÂ§áÂøò"><span class="toc-text">‰∏Ä‰∫õÂ§áÂøò</span></a></li></ol>
</div>
            </div>
        </div>
    
    </div>
</div>
                    <!-- main card end -->
                </div>
            
            <div id="page-content" class="col-lg-8">
                <div class="trm-content" id="trm-content">
                    <div data-scroll data-scroll-repeat data-scroll-offset="500" id="about-triger"></div>

                    <div id="post-info" class="row hidden-sm">
    <div class="col-sm-4">
        <div class="trm-card trm-label trm-label-light text-center">
            <i class="iconfont far fa-calendar-alt trm-icon"></i><br>
            11/19
        </div>
    </div>
    <div class="col-sm-4">
        <div class="trm-card trm-label trm-label-light text-center">
            <i class="iconfont fas fa-yin-yang trm-icon"></i><br>
            00:47
        </div>
    </div>
    <div class="col-sm-4">
        <div id="post-author" class="trm-card trm-label trm-label-light text-center">
            <i class="iconfont fas fa-user-secret trm-icon"></i><br>
            Hur1k
        </div>
    </div>
</div>
<div class="trm-card ">
    <article id="article-container" class="trm-publication">
    <p>Á¨¨‰∏ÄÁØáWP (‚ïπ⁄°‚ïπ )</p>
<p>‰ªéÂÜ≥ËµõÂà∞Áé∞Âú®Â§ßÊ¶ÇÊòØ2Âë®ÁöÑÊó∂Èó¥,Áªà‰∫éÁÆóÊòØÂÅöÂÆå‰∫Üüò≠</p>
<p>GhidraÁ´üÁÑ∂ËÉΩÊâìÂºÄ!!ËôΩÁÑ∂ÂèçÁºñËØëÂ±Ç‰πüÊòØÊúâÁÇπÈöæ,ÂÅöÂÆåÂêéÂèëÁé∞ÂÖ∂ÂÆûÂä†ÂØÜÊìç‰Ωú‰∏çÁÆóÈöæ,Âè™ÊòØÊû∂ÊûÑÈóÆÈ¢òÊääÂæàÂ§öÊìç‰ΩúÈÉΩÂ§çÊùÇÂåñ‰∫Ü</p>
<p>ËôΩÁÑ∂Ëä±ÁöÑÊó∂Èó¥ÊØîËæÉ‰πÖ,‰ΩÜÊÄªÁöÑÊù•ËØ¥Êî∂Ëé∑ËøòÊòØÊå∫Â§ßÁöÑ,‰ª•Ââç‰∏ÄÁõ¥‰æùËµñÁùÄË¥µÂ¶áÂ§¥ÁöÑÂä®Ë∞ÉÂ∑•ÂÖ∑,ÂæàÂ∞ëÁî®Âà∞Âè™ÊúâÂèçÊ±áÁºñÊ≤°ÊúâÂèçÁºñËØëÁöÑÂ∑•ÂÖ∑Â¶Çgdb(gdbÈÉΩ‰∏ç‰ºöÁî®!ËØ•Êâì!),Âè¶Â§ñ‰πüÁªÉ‰π†‰∫Ü‰∏Ä‰∏ãÁü©ÈòµÁ±ªÁöÑÈ¢òÁõÆ,Áõ∏ÂÖ≥Â∫ì(numpy,sympy)ÁöÑ‰ΩøÁî®,ÁªßÁª≠Âä†Ê≤π~</p>
<h1 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ÁàÜÁ†¥ËÑöÊú¨</span></span><br><span class="line"></span><br><span class="line">enc = [<span class="number">0x23</span>, <span class="number">0x58</span>, <span class="number">0x64</span>, <span class="number">0x0c</span>, <span class="number">0x3a</span>, <span class="number">0x6a</span>, <span class="number">0x7c</span>, <span class="number">0x09</span>, <span class="number">0x65</span>, <span class="number">0x65</span>, <span class="number">0x02</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x7a</span>, <span class="number">0x4a</span>, <span class="number">0x10</span>, <span class="number">0x3e</span>, <span class="number">0x1a</span>, <span class="number">0x45</span>, <span class="number">0x01</span>,</span><br><span class="line">    <span class="number">0x3a</span>, <span class="number">0x09</span>, <span class="number">0x02</span>, <span class="number">0x72</span>, <span class="number">0x3e</span>, <span class="number">0x15</span>, <span class="number">0x74</span>, <span class="number">0x0b</span>, <span class="number">0x25</span>, <span class="number">0x55</span>, <span class="number">0x03</span>, <span class="number">0x35</span>, <span class="number">0x60</span>, <span class="number">0x75</span>, <span class="number">0x68</span>, <span class="number">0x68</span>]</span><br><span class="line">xor_list=[<span class="number">0x11</span>,<span class="number">0x22</span>,<span class="number">0x33</span>,<span class="number">0x44</span>]</span><br><span class="line">fakekey=<span class="string">&#x27;flag&#123;No!I_am_not_the_key&#125;&#x27;</span></span><br><span class="line">fakekey=<span class="built_in">list</span>(fakekey.encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">b64Magic</span>(<span class="params">magicDic,plaintext</span>):</span><br><span class="line">    <span class="keyword">import</span> base64</span><br><span class="line">    str1=plaintext</span><br><span class="line">    string1=magicDic</span><br><span class="line">    string2 = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">    <span class="built_in">print</span> (base64.b64decode(str1.translate(<span class="built_in">str</span>.maketrans(string1,string2))))</span><br><span class="line">    <span class="keyword">return</span> base64.b64decode(str1.translate(<span class="built_in">str</span>.maketrans(string1,string2)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix_line_mul</span>(<span class="params">line,i</span>):</span><br><span class="line">    tmp=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        tmp+=(fakekey[k+i*<span class="number">5</span>]*line[k])</span><br><span class="line">    <span class="keyword">return</span> tmp%<span class="number">0x101</span></span><br><span class="line">            </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)-<span class="number">2</span>):</span><br><span class="line">        enc[i]^=xor_list[i%<span class="number">4</span>]</span><br><span class="line">    enc[-<span class="number">1</span>]=<span class="built_in">ord</span>(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">    enc[-<span class="number">2</span>]=<span class="built_in">ord</span>(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytes</span>(enc))</span><br><span class="line">    magicDic=<span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ9876543210+/&#x27;</span></span><br><span class="line">    dec1=<span class="built_in">list</span>(b64Magic(magicDic,<span class="built_in">bytes</span>(enc).decode()))</span><br><span class="line">    </span><br><span class="line">    ans=[]</span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">    j=<span class="number">2</span> <span class="comment">#ÊîπËøô</span></span><br><span class="line">    a=<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) <span class="comment">#ÊîπËøô</span></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">            <span class="keyword">if</span> c%<span class="number">10</span>==<span class="number">0</span>: <span class="comment">#ÁõëËßÜËøõÂ∫¶(ÂÆâÂÖ®ÊÑü)</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;b:<span class="subst">&#123;<span class="built_in">chr</span>(b)&#125;</span> c:<span class="subst">&#123;<span class="built_in">chr</span>(c)&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">                <span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">                    data=[a,b,c,d,e]</span><br><span class="line">                    <span class="comment"># print(matrix_line_mul(data,0))</span></span><br><span class="line">                    <span class="keyword">if</span> matrix_line_mul(data,<span class="number">0</span>) == dec1[<span class="number">0</span>*<span class="number">5</span>+j]:</span><br><span class="line">                        <span class="keyword">if</span> matrix_line_mul(data,<span class="number">1</span>) == dec1[<span class="number">1</span>*<span class="number">5</span>+j]:</span><br><span class="line">                            <span class="keyword">if</span> matrix_line_mul(data,<span class="number">2</span>) == dec1[<span class="number">2</span>*<span class="number">5</span>+j]:</span><br><span class="line">                                <span class="keyword">if</span> matrix_line_mul(data,<span class="number">3</span>) == dec1[<span class="number">3</span>*<span class="number">5</span>+j]:</span><br><span class="line">                                    <span class="keyword">if</span> matrix_line_mul(data,<span class="number">4</span>) == dec1[<span class="number">4</span>*<span class="number">5</span>+j]:</span><br><span class="line">                                        <span class="built_in">print</span>(<span class="string">f&quot;Found! <span class="subst">&#123;data&#125;</span> <span class="subst">&#123;<span class="built_in">bytes</span>(data)&#125;</span>&quot;</span>)</span><br><span class="line">                                        <span class="built_in">breakpoint</span>()</span><br><span class="line">                                        ans.append(data)</span><br><span class="line">    <span class="built_in">print</span>(ans)</span><br><span class="line">main()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Ê≠£ËßÑÂÜõËÑöÊú¨,Áî®Âà∞‰∫Üsympy</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line">np.set_printoptions(suppress=<span class="literal">True</span>) <span class="comment">#‰∏ç‰ΩøÁî®ÁßëÂ≠¶ËÆ°Êï∞Ê≥ï</span></span><br><span class="line"></span><br><span class="line">enc = [<span class="number">0x23</span>, <span class="number">0x58</span>, <span class="number">0x64</span>, <span class="number">0x0c</span>, <span class="number">0x3a</span>, <span class="number">0x6a</span>, <span class="number">0x7c</span>, <span class="number">0x09</span>, <span class="number">0x65</span>, <span class="number">0x65</span>, <span class="number">0x02</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x7a</span>, <span class="number">0x4a</span>, <span class="number">0x10</span>, <span class="number">0x3e</span>, <span class="number">0x1a</span>, <span class="number">0x45</span>, <span class="number">0x01</span>,</span><br><span class="line">    <span class="number">0x3a</span>, <span class="number">0x09</span>, <span class="number">0x02</span>, <span class="number">0x72</span>, <span class="number">0x3e</span>, <span class="number">0x15</span>, <span class="number">0x74</span>, <span class="number">0x0b</span>, <span class="number">0x25</span>, <span class="number">0x55</span>, <span class="number">0x03</span>, <span class="number">0x35</span>, <span class="number">0x60</span>, <span class="number">0x75</span>, <span class="number">0x68</span>, <span class="number">0x68</span>]</span><br><span class="line">xor_list=[<span class="number">0x11</span>,<span class="number">0x22</span>,<span class="number">0x33</span>,<span class="number">0x44</span>]</span><br><span class="line"></span><br><span class="line">enc1=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">b64Magic</span>(<span class="params">magicDic,plaintext</span>):</span><br><span class="line">    <span class="keyword">import</span> base64</span><br><span class="line">    str1=plaintext</span><br><span class="line">    string1=magicDic</span><br><span class="line">    string2 = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">    <span class="built_in">print</span> (base64.b64decode(str1.translate(<span class="built_in">str</span>.maketrans(string1,string2))))</span><br><span class="line">    <span class="keyword">return</span> base64.b64decode(str1.translate(<span class="built_in">str</span>.maketrans(string1,string2)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    fakekey=<span class="string">&#x27;flag&#123;No!I_am_not_the_key&#125;&#x27;</span></span><br><span class="line">    fakekey=<span class="built_in">list</span>(fakekey.encode())</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)-<span class="number">2</span>):</span><br><span class="line">        enc[i]^=xor_list[i%<span class="number">4</span>]</span><br><span class="line">    enc[-<span class="number">1</span>]=<span class="built_in">ord</span>(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">    enc[-<span class="number">2</span>]=<span class="built_in">ord</span>(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytes</span>(enc))</span><br><span class="line">    magicDic=<span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ9876543210+/&#x27;</span></span><br><span class="line">    dec1=<span class="built_in">list</span>(b64Magic(magicDic,<span class="built_in">bytes</span>(enc).decode()))</span><br><span class="line">   </span><br><span class="line">    fakekey=sympy.Matrix(fakekey).reshape(<span class="number">5</span>,<span class="number">5</span>)</span><br><span class="line">    dec1=sympy.Matrix(dec1).reshape(<span class="number">5</span>,<span class="number">5</span>)</span><br><span class="line">    fakekey_inv=fakekey.inv_mod(<span class="number">0x101</span>)</span><br><span class="line">    flag=fakekey_inv*dec1%<span class="number">0x101</span></span><br><span class="line">    sympy.pprint(flag)</span><br><span class="line">main()</span><br></pre></td></tr></table></figure>

<h1 id="ÁúÅÊµÅ"><a href="#ÁúÅÊµÅ" class="headerlink" title="ÁúÅÊµÅ"></a>ÁúÅÊµÅ</h1><p>ÊúâÈôêÂüüÁü©Èòµ‰πòÊ≥ï+Â§çÂà∂Êìç‰Ωú+base64È≠îÊîπ(Êç¢Ë°®+ÂºÇÊàñ)</p>
<h1 id="‰∏Ä‰∫õÁßØÁ¥Ø"><a href="#‰∏Ä‰∫õÁßØÁ¥Ø" class="headerlink" title="‰∏Ä‰∫õÁßØÁ¥Ø"></a>‰∏Ä‰∫õÁßØÁ¥Ø</h1><p><code>x &amp; p</code> ÂÖ∂‰∏≠p‰∏∫ÂΩ¢Â¶Ç0b1, 0b11, 0b111,ÈÇ£‰πàÊïàÊûúÁõ∏ÂΩì‰∫é<code>x % (p+1)</code></p>
<h3 id="RiscvÂØÑÂ≠òÂô®"><a href="#RiscvÂØÑÂ≠òÂô®" class="headerlink" title="RiscvÂØÑÂ≠òÂô®"></a>RiscvÂØÑÂ≠òÂô®</h3><p>Âè¶Â§ñÊ≥®ÊÑèriscvÂíåi386ÁöÑ‰∏çÂêå</p>
<p><code>x8/s0/fp</code> saved register „ÄÅframe pointer</p>
<p><code>x10 / a0</code> (function argument, return value)</p>
<p><code>x11 / a1</code>(function argument, return value)</p>
<p><code>x18 / s2</code> (saved register)</p>
<ul>
<li><p>ÂØÑÂ≠òÂô®</p>
<p>  <img src="/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/1.png" loading="lazy"></p>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://lab.cs.tsinghua.edu.cn/cod-lab-docs/labs/4-riscv-inst/">RISC-V Êåá‰ª§Ê¶ÇÂÜµ</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/George-Okelly1995/p/9801357.html">[ËÆ°ÁÆóÊú∫Á°¨‰ª∂] RISC-V Ê±áÁºñÊåá‰ª§Á¨îËÆ∞</a></p>
<p>ÊÑüËßâÊõ¥ÂÖ®‰∏ÄÁÇπ</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/558799873">ËÆ°Âü∫(‰∫å)RISC-VÊåá‰ª§ÈõÜ‰ªãÁªç‰∏éÊ±áÁºñ</a></p>
<h1 id="ËøêË°å-Âä®Ë∞É"><a href="#ËøêË°å-Âä®Ë∞É" class="headerlink" title="ËøêË°å+Âä®Ë∞É"></a>ËøêË°å+Âä®Ë∞É</h1><blockquote>
<p>ÊÄªÁªì‰∫Ü‰∏Ä‰∏ã‰∏çÂêåÊû∂ÊûÑÁöÑËøêË°åÂä†Âä®Ë∞ÉÊñπÊ≥ï,ÁâπÂà´ÊÑüË∞¢Â§ß‰Ω¨stdlibhÊïôÊàëÈÖçÁéØÂ¢Éüò≠</p>
</blockquote>
<h2 id="Áõ∏ÂÖ≥Â∑•ÂÖ∑"><a href="#Áõ∏ÂÖ≥Â∑•ÂÖ∑" class="headerlink" title="Áõ∏ÂÖ≥Â∑•ÂÖ∑"></a>Áõ∏ÂÖ≥Â∑•ÂÖ∑</h2><blockquote>
<p>Âè™ÊòØÂàó‰∏æ‰∫Ü‰∏Ä‰∏ã,ÂÆûÈôÖ‰∏äÊ≤°Áî®Âà∞ÈÇ£‰πàÂ§ö</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install qemu qemu-user qemu-user-static gdb gdb-multiarch <span class="string">&#x27;binfmt*&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>qemuÁ≥ªÁªüÊÄÅ</li>
<li>qemu-user-staticÁî®Êà∑ÊÄÅ(static‰∏çÁü•ÈÅìÂï•)</li>
<li>gdb</li>
<li>gdb-multiarch</li>
<li>binfmtÂèØ‰ª•‰ΩøÁî®ËØ•ÂåÖÊü•ÁúãÊñá‰ª∂ÁöÑÁ±ªÂûã,Âπ∂Ëá™Âä®Ë∞ÉÁî®Ê≠£Á°ÆÁöÑËß£ÈáäÂô®.</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ÂÆâË£ÖgdbÊèí‰ª∂pwndbg(ÊàñËÄÖgefÁ≠âÊîØÊåÅÂ§öÊû∂ÊûÑÁöÑÊèí‰ª∂)</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/pwndbg/pwndbg</span><br><span class="line"><span class="built_in">cd</span> pwndbg</span><br><span class="line">./setup.sh</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ÂÆâË£Öriscv-gnu-toolchain</span></span><br><span class="line"><span class="comment"># https://github.com/riscv-collab/riscv-gnu-toolchain</span></span><br><span class="line"><span class="comment"># Áõ¥Êé•Âú®Release‰∏≠ÊâæÂØπÂ∫îÁöÑÂéãÁº©ÂåÖ‰∏ãËΩΩÂç≥ÂèØ</span></span><br><span class="line">riscv64-elf-ubuntu-20.04-nightly-2022.11.12-nightly.tar.gz</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="ÈùôÊÄÅÈìæÊé•ËøêË°å"><a href="#ÈùôÊÄÅÈìæÊé•ËøêË°å" class="headerlink" title="ÈùôÊÄÅÈìæÊé•ËøêË°å"></a>ÈùôÊÄÅÈìæÊé•ËøêË°å</h2><h3 id="ÊñπÊ≥ï1"><a href="#ÊñπÊ≥ï1" class="headerlink" title="ÊñπÊ≥ï1"></a>ÊñπÊ≥ï1</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">file ./arch</span><br><span class="line">./arch</span><br></pre></td></tr></table></figure>

<ul>
<li><p>ÂÖàfileÊü•ÁúãÊñá‰ª∂Á±ªÂûã,ËøôÈáåarchÊòØÊñá‰ª∂Âêç,‰ª•ÂèäÈìæÊé•ÊñπÊ≥ï</p>
</li>
<li><p>ËøôÊó∂ÂÄôÂèØ‰ª•Áõ¥Êé•ËøêË°å</p>
<p>  ÂéüÂõ†(<a target="_blank" rel="noopener" href="https://danielmangum.com/posts/risc-v-bytes-qemu-gdb/">ÂèÇËÄÉ</a>):linuxÂÜÖÊ†∏ÊîØÊåÅ‰∏Ä‰∏™ÁâπÊÄß:binfmt_misc, ÂÖÅËÆ∏‰∏∫ÊåáÂÆöÁöÑ‰∫åËøõÂà∂Á±ªÂûãËá™Âä®Ê≥®ÂÜåÂíåË∞ÉÁî®Ëß£ÈáäÂô®,ÂÆâË£Ö‰∫ÜqemuÂêéÂÆÉÂ∞±ÂèØ‰ª•Áî®‰∫Ü,ÂèØ‰ª•<code>ls /proc/sys/fs/binfmt_misc/</code> Êü•ÁúãËØ¶ÊÉÖ</p>
</li>
</ul>
<h3 id="ÊñπÊ≥ï2-ÂèÇËÄÉ"><a href="#ÊñπÊ≥ï2-ÂèÇËÄÉ" class="headerlink" title="ÊñπÊ≥ï2(ÂèÇËÄÉ)"></a>ÊñπÊ≥ï2(<a target="_blank" rel="noopener" href="https://blog.csdn.net/Homewm/article/details/103574535">ÂèÇËÄÉ</a>)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> /usr/bin/qemu-riscv-static ./</span><br><span class="line">sudo <span class="built_in">chroot</span> . ./qemu-riscv-static ./arch</span><br></pre></td></tr></table></figure>

<ul>
<li>cp‰πüÂèØ‰ª•ÂÜô‰∏∫<code>cp which qemu-mips-static ./</code></li>
<li><code>sudo chroot .</code>  ÂèØ‰ª•‰∏çÂÜô</li>
<li>ËøôÁßçÂ±û‰∫éÁõ¥Êé•ÊääÁõ∏Â∫îÁöÑËøêË°åÂô®ÊãâÂá∫Êù•‰ΩøÁî®</li>
</ul>
<h2 id="Âä®ÊÄÅÈìæÊé•ËøêË°å-ËøòÊ≤°ËØïËøá"><a href="#Âä®ÊÄÅÈìæÊé•ËøêË°å-ËøòÊ≤°ËØïËøá" class="headerlink" title="Âä®ÊÄÅÈìæÊé•ËøêË°å(ËøòÊ≤°ËØïËøá)"></a>Âä®ÊÄÅÈìæÊé•ËøêË°å(ËøòÊ≤°ËØïËøá)</h2><h3 id="ÂÆâË£ÖÂÖ±‰∫´Â∫ì-ÂèÇËÄÉ"><a href="#ÂÆâË£ÖÂÖ±‰∫´Â∫ì-ÂèÇËÄÉ" class="headerlink" title="ÂÆâË£ÖÂÖ±‰∫´Â∫ì(ÂèÇËÄÉ)"></a>ÂÆâË£ÖÂÖ±‰∫´Â∫ì(<a target="_blank" rel="noopener" href="https://www.cnblogs.com/WangAoBo/p/debug-arm-mips-on-linux.html">ÂèÇËÄÉ</a>)</h3><p><code>apt-cache search &quot;libc6&quot; | grep riscv</code></p>
<p>ÁÑ∂ÂêéÂÆâË£ÖÂØπÂ∫îÁöÑÂ∫ìÂç≥ÂèØ</p>
<h3 id="ÊåáÂÆöÂÖ±‰∫´Â∫ì"><a href="#ÊåáÂÆöÂÖ±‰∫´Â∫ì" class="headerlink" title="ÊåáÂÆöÂÖ±‰∫´Â∫ì"></a>ÊåáÂÆöÂÖ±‰∫´Â∫ì</h3><p><code>qemu-mipsel -L /usr/mipsel-linux-gnu/ ./arch</code></p>
<ul>
<li>Ê≥®ÊÑè:‰ªÖ‰∏∫Á§∫‰æã‰ª£Á†Å</li>
<li>Á¨¨‰∏Ä‰∏™ÊòØËøêË°åÂô®,-LÊåáÂÆöÂÖ±‰∫´Â∫ì</li>
</ul>
<h2 id="Âä®ÊÄÅË∞ÉËØï"><a href="#Âä®ÊÄÅË∞ÉËØï" class="headerlink" title="Âä®ÊÄÅË∞ÉËØï"></a>Âä®ÊÄÅË∞ÉËØï</h2><h3 id="Â∞ùËØï‰∏Ä"><a href="#Â∞ùËØï‰∏Ä" class="headerlink" title="Â∞ùËØï‰∏Ä"></a>Â∞ùËØï‰∏Ä</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">qemu-mipsel -g 1234 -L /usr/mipsel-linux-gnu/ ./arch</span><br><span class="line">gdb-multiarch</span><br><span class="line"><span class="built_in">set</span> architecture mips</span><br><span class="line">target remote localhost:1234</span><br></pre></td></tr></table></figure>

<ul>
<li>Á§∫‰æã‰ª£Á†Å,-gÊåáÂÆöÁ´ØÂè£</li>
<li>‰ΩøÁî®gdb-multiarchËøõË°åË∞ÉËØï,ËÆæÁΩÆÂ•ΩÊû∂ÊûÑ(tabÊü•ÁúãËØ¶ÊÉÖ,‰πüÂèØ‰ª•ËÆæÁΩÆ‰∏∫auto)</li>
<li>ÊåáÂÆöË∞ÉËØïÁöÑÁõÆÊ†áÁ´ØÂè£‰ΩçÁΩÆ</li>
<li><strong>ÁÑ∂ÂêéËøôÈÅìÈ¢òÊàëÁî®Ëøô‰∏™ÊñπÊ≥ï‰∏çÊàêÂäü</strong></li>
</ul>
<h3 id="Â∞ùËØï‰∫å"><a href="#Â∞ùËØï‰∫å" class="headerlink" title="Â∞ùËØï‰∫å"></a>Â∞ùËØï‰∫å</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo qemu-riscv64 -g 9999 <span class="built_in">arch</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo ./riscv64-unknown-elf-gdb</span><br><span class="line">file <span class="built_in">arch</span>     <span class="comment">#(No debugging symbols found in arch)</span></span><br><span class="line">targe remote :9999</span><br></pre></td></tr></table></figure>

<ul>
<li>‰∏Ä‰∏™Á™óÂè£ÂºÄgdbserver,‰∏Ä‰∏™ÊéßÂà∂gdb</li>
<li><strong>sudoË¶ÅÂä†‰∏ä,‰∏çÁü•ÈÅì‰∏∫Âï•Êàë‰∏çÂä†Â∞±Âä®Ë∞É‰∏ç‰∫Ü</strong></li>
<li>Âú®bash‰∏≠fileÁöÑÊó∂ÂÄôËØ¥<strong>stripped</strong>,ÊâÄ‰ª•Ê≤°ÊúâÁ¨¶Âè∑‰ø°ÊÅØ,ËøôÊó∂ÂÄôgdbÂè™ËÉΩÊéßÂà∂continue,‰∏çËÉΩÁõ¥Êé•‰∏ãÊñ≠ÁÇπ,ÂçïÊ≠•Êìç‰ΩúÁ≠â,ÊâÄ‰ª•Ë∞ÉËØïÂèòÂæóÈùûÂ∏∏È∫ªÁÉ¶,ÂΩìÊó∂Âè™ËÉΩÁªôÂú∞ÂùÄ‰∏ãÊñ≠ÁÇπÂ¶Ç<code>b *0x10dbe</code> ,<strong>‰ΩÜÊòØÊàëËßâÂæóËøôÁßçÊÉÖÂÜµÂ∫îËØ•ËøòÊòØÂèØ‰ª•ÂçïÊ≠•Ë∞ÉËØïÁöÑ,Â∏åÊúõÊúâÂ§ß‰Ω¨ËÉΩËß£Á≠î‰∏Ä‰∏ãÊñπÊ≥ï</strong></li>
</ul>
<p>ÁÑ∂ÂêéÂ∞±ÂèØ‰ª•ÊÑâÂø´ÁöÑÂÅöÈ¢òÂï¶üòù</p>
<h1 id="Hacking1-ÊúâÈôêÂüüÁü©Èòµ‰πòÊ≥ï"><a href="#Hacking1-ÊúâÈôêÂüüÁü©Èòµ‰πòÊ≥ï" class="headerlink" title="Hacking1-ÊúâÈôêÂüüÁü©Èòµ‰πòÊ≥ï"></a>Hacking1-ÊúâÈôêÂüüÁü©Èòµ‰πòÊ≥ï</h1><p>‰∏ÄÂºÄÂßã‰∏ÄÁõ¥Âú®Á∫†ÁªìIDAÊÄé‰πàÊâìÂºÄ,ÊâìÂºÄÂêéÂèà‰∏çËÉΩÂä®Ë∞É‰∏çËÉΩÂèçÁºñËØë,ÂêéÈù¢ÊäòËÖæÁéØÂ¢ÉÂéª‰∫Ü,ÂÜ≥ËµõÁªìÊùü</p>
<p>ÁªèÊèêÁÇπÁî®GhidraÊâìÂºÄ,ÂèëÁé∞Êñ∞‰∏ñÁïåüò≠</p>
<p>ÂÖàÁúãmain_funcÁöÑÈÄªËæë:Ëé∑ÂèñËæìÂÖ•‚ÜíËøõÂÖ•FUN_000108d4Â§ÑÁêÜinput‚Üíbase64_magicÂ§ÑÁêÜ‚ÜíËøõÂÖ•FUN_00023c82ËøõË°åÊØîËæÉ</p>
<p><img src="/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/2.png" loading="lazy"></p>
<p>ËøõÂÖ•FUN_000108d4ÂèØ‰ª•ÁúãÂà∞‰∏â‰∏™forÂæ™ÁéØ,ÂàÜÊûê‰∏Ä‰∏ã,ÁúãÊ≥®Èáä(ËøôÈáåÂ∞±ÊòØ<strong>ÊúâÈôêÂüüÁü©Èòµ‰πòÊ≥ï</strong>)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">FUN_000108d4</span><span class="params">(<span class="type">long</span> param_1)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  undefined8 enc1;</span><br><span class="line">  undefined8 local_48;</span><br><span class="line">  undefined8 local_40;</span><br><span class="line">  undefined local_38;</span><br><span class="line">  ulong k;</span><br><span class="line">  uint sum;</span><br><span class="line">  ulong j;</span><br><span class="line">  ulong i;</span><br><span class="line">  </span><br><span class="line">  enc1 = <span class="number">0</span>;</span><br><span class="line">  local_48 = <span class="number">0</span>;</span><br><span class="line">  local_40 = <span class="number">0</span>;</span><br><span class="line">  local_38 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i = i + <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">5</span>; j = j + <span class="number">1</span>) &#123;</span><br><span class="line">                      <span class="comment">/* ÈáçÁΩÆlocal_24 */</span></span><br><span class="line">      sum = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; <span class="number">5</span>; k = k + <span class="number">1</span>) &#123;</span><br><span class="line">                      <span class="comment">/* local_24 += fakekey[k+i*5]*a1[j+k*5] */</span></span><br><span class="line">         sum = (uint)*(byte *)(k + i * <span class="number">5</span> + <span class="number">0x7c000</span>) * (uint)*(byte *)(j + k * <span class="number">5</span> + param_1) + sum;</span><br><span class="line">      &#125;</span><br><span class="line">                      <span class="comment">/* local_50[j+i*5] = local_24 % 0x101 */</span></span><br><span class="line">      *(<span class="type">char</span> *)((<span class="type">long</span>)&amp;enc1 + j + i * <span class="number">5</span>) = (<span class="type">char</span>)(sum % <span class="number">0x101</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  FUN_000241f8(param_1,&amp;enc1,<span class="number">25</span>);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Hacking2-Â§çÂà∂"><a href="#Hacking2-Â§çÂà∂" class="headerlink" title="Hacking2-Â§çÂà∂"></a>Hacking2-Â§çÂà∂</h1><p>ËøõÂÖ•FUN_000241f8,ËøôÈáåÂºÄÂßãÂ∞±Âæà‰π±‰∫Ü,‰πüÊòØÂàÜÊûêÁöÑÈáçÁÇπ,ÂæàÂ§ö‰ª£Á†ÅÊó†ÊÑè‰πâËøôÊó∂ÂÄôÂè™ËÉΩÊÖ¢ÊÖ¢Êù•,ÁªìÂêàÂä®Ë∞É+Ê±áÁºñ+‰º™‰ª£Á†ÅÊù•ÂàÜÊûê,‰ΩÜÊòØ‰πãÈó¥Âêå‰∏ÄÊÆµ‰ª£Á†ÅÁî®ÁöÑÂèòÈáèÂèà‰∏ç‰∏ÄÊ†∑,‰∏çÁü•ÈÅìÊòØ‰ªÄ‰πàÂéüÂõ†</p>
<p>ÂèçÊ≠£Ë∑üÁùÄËµ∞‰∏ÄÈÅçËøáÁ®ã,Â∞±ÂèØ‰ª•ÂèëÁé∞ÊØèÊ¨°Á®ãÂ∫èÈÉΩÂè™‰ºöËøõÂÖ•FUN_0002428c()(Âõ†‰∏∫lenÊåáÂÆöÂ•ΩÊòØ25‰∫Ü),ËÄåÈáåÈù¢ÊòØÊääenc1ÁöÑÊï∞ÊçÆÂ§çÂà∂Âà∞input(Â§çÂà∂ÁöÑÈïøÂ∫¶ÊòØ8ÁöÑÂÄçÊï∞),Ââ©‰∏ãÊ≤°Â§çÂà∂ÁöÑÂú®Êú¨ÂáΩÊï∞ÁöÑÊúÄÂêé‰∏ÄÈÉ®ÂàÜ‰ºöËøõË°åÂ§çÂà∂,ËØ¥ÁôΩ‰∫ÜÂ∞±ÊòØÂÖ®ÈÉ®Â§çÂà∂</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">undefined * <span class="title function_">FUN_000241f8</span><span class="params">(undefined *input,undefined *enc1,ulong len)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  ulong uVar3;</span><br><span class="line">  ulong uVar4;</span><br><span class="line">  undefined *puVar5;</span><br><span class="line">  undefined *input_p;</span><br><span class="line">  undefined *enc1_p;</span><br><span class="line">  undefined enc1_ch;</span><br><span class="line">  <span class="type">long</span> lVar2;</span><br><span class="line">  </span><br><span class="line">  input_p = input;</span><br><span class="line">  <span class="keyword">if</span> (<span class="number">0xf</span> &lt; len) &#123;</span><br><span class="line">                      <span class="comment">/* ÊúâÁÇπÂ•áÊÄ™,v4Á´üÁÑ∂ÊòØÊãøÂú∞ÂùÄÂéª%8ÁöÑ?? */</span></span><br><span class="line">    uVar4 = -(<span class="type">long</span>)input &amp; <span class="number">7</span>;</span><br><span class="line">    uVar3 = len - uVar4;</span><br><span class="line">                      <span class="comment">/* != 0 8 16 24 ... */</span></span><br><span class="line">    <span class="keyword">if</span> (uVar4 != <span class="number">0</span>) &#123;</span><br><span class="line">                      <span class="comment">/* encÁöÑÂÄºÂ§çÂà∂Âà∞input,ËåÉÂõ¥ÊòØ[:?] */</span></span><br><span class="line">      enc1_p = enc1;</span><br><span class="line">      <span class="keyword">do</span> &#123;</span><br><span class="line">         enc1_ch = *enc1_p;</span><br><span class="line">                      <span class="comment">/* Ëá™Âä†Áî®,‰∏çÁÆ° */</span></span><br><span class="line">         puVar5 = input_p + <span class="number">1</span>;</span><br><span class="line">         enc1_p = enc1_p + <span class="number">1</span>;</span><br><span class="line">         *input_p = enc1_ch;</span><br><span class="line">         input_p = puVar5;</span><br><span class="line">      &#125; <span class="keyword">while</span> (input + uVar4 != puVar5);</span><br><span class="line">                      <span class="comment">/*   */</span></span><br><span class="line">      enc1 = enc1 + uVar4;</span><br><span class="line">      input_p = input + uVar4;</span><br><span class="line">    &#125;</span><br><span class="line">                      <span class="comment">/*    */</span></span><br><span class="line">    <span class="keyword">if</span> (((ulong)enc1 &amp; <span class="number">7</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">                      <span class="comment">/* ËøôÈáåÂíå‰∏ãÈù¢ÈÇ£‰∏™ÂáΩÊï∞Â∫îËØ•ÂèçÁºñËØëÊúâÁÇπÈóÆÈ¢ò,‰ΩÜÊòØ‰ªñ‰ª¨ÁöÑÂèÇÊï∞ÊòØ‰∏ÄÊ†∑ÁöÑ*/</span></span><br><span class="line">      FUN_0002428c();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      FUN_00024370(input_p,enc1,uVar3 &gt;&gt; <span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">                      <span class="comment">/* enc1 += uVar3&amp;(-8),</span></span><br><span class="line"><span class="comment">                         enc1Ëá™Âä†ÁöÑÊòØ:ÊúÄÂ§ßÁöÑÂ∞è‰∫éuVar3‰∏îÂèØ‰ª•Êï¥Èô§8ÁöÑÊï∞</span></span><br><span class="line"><span class="comment">                         enc1Êõ¥Êñ∞</span></span><br><span class="line"><span class="comment">                          */</span></span><br><span class="line">    enc1 = enc1 + (uVar3 &amp; uVar1);</span><br><span class="line">                      <span class="comment">/* len = len % 8 */</span></span><br><span class="line">    len = uVar3 &amp; <span class="number">7</span>;</span><br><span class="line">                      <span class="comment">/* ËøôÈáåÂæàÂ•áÊÄ™,ÊòéÊòéÁÆóËøáÊòØ+24ÁöÑ,ÁªìÊûúÂä†ÁöÑÊòØ23=0x19 */</span></span><br><span class="line">    input_p = input_p + (uVar3 &amp; uVar1);</span><br><span class="line">  &#125;</span><br><span class="line">                      <span class="comment">/*  Áé∞Âú®ÁöÑenc1_pÊòØ+24+1 */</span></span><br><span class="line">  enc1_p = enc1 + len;</span><br><span class="line">  lVar2 = <span class="number">-1</span> - (<span class="type">long</span>)enc1;</span><br><span class="line">                      <span class="comment">/* ËøòÊ≤°ÁúãÊáÇËøôÈáå */</span></span><br><span class="line">                      <span class="comment">/* Â§áÊ≥®‰∏Ä‰∏ã,ÂÖ∂ÂÆûËøô‰∏ÄÊÆµÁöÑ‰ª£Á†ÅÂèçÁºñËØëÁúüÁöÑÂæà‰π±,ÁúãÁùÄÊÑüËßâ‰ª£Á†Å‰πãÈó¥Ê≤°‰ªÄ‰πàÊÑè‰πâ,ÊàëÊòØÁªìÂêàÊ±áÁºñÂíå‰º™‰ª£Á†ÅÊù•ÁúãÁöÑ, ËÄå‰∏î‰∏§ËÄÖ‰πãÈó¥Âêå‰∏ÄÊÆµ‰ª£Á†ÅÁî®ÁöÑÂèòÈáèÂèà‰∏ç‰∏ÄÊ†∑,‰∏çÁü•ÈÅìÊòØ‰ªÄ‰πàÂéüÂõ†</span></span><br><span class="line"><span class="comment">                         </span></span><br><span class="line"><span class="comment">                         Ëøô‰∏ÄÊÆµÊÑüËßâÂ∞±ÊòØÊääÂâçÈù¢Ê≤°Â§çÂà∂ÂÆåÁöÑÂ§çÂà∂ËøáÂéª... */</span></span><br><span class="line">  <span class="keyword">if</span> (len != <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">                      <span class="comment">/* ÊãøÂá∫ÊúÄÂêé‰∏Ä‰∏™ÂÄº(ÊúÄÂêé‰∏Ä‰∏™Â∞±ÊòØËøòÊ≤°ÊúâË¢´Â§çÂà∂ÁöÑ) */</span></span><br><span class="line">      enc1_ch = *enc1;</span><br><span class="line">      enc1 = enc1 + <span class="number">1</span>;</span><br><span class="line">      enc1[(<span class="type">long</span>)(input_p + lVar2)] = enc1_ch;</span><br><span class="line">    &#125; <span class="keyword">while</span> (enc1_p != enc1);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> input;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Hacking3-base64È≠îÊîπ"><a href="#Hacking3-base64È≠îÊîπ" class="headerlink" title="Hacking3-base64È≠îÊîπ"></a>Hacking3-base64È≠îÊîπ</h1><p>ÁúãÂà∞Ëøô‰∏≤‰∏úË•øÂ∫îËØ•ÂæàÊòéÊòæ‰∫ÜÂêß,ÂêåÊó∂Ê≥®ÊÑèÂà∞</p>
<ul>
<li>ÊúâÊç¢Ë°®</li>
<li>3Êç¢4‰πãÂêéÁöÑÂºÇÊàñÊìç‰Ωú(11h,22h,33h,44h)</li>
<li>Â°´ÂÖÖÁ¨¶‰∏∫‚Äôh‚Äô</li>
</ul>
<p>Ëøô‰∏™Â∞±Â•ΩÈÄÜ‰∫Ü,‰∏çËøá‰πãÂâçÊÉ≥Â§ö‰∫Ü‰ª•‰∏∫ÂºÇÊàñÊìç‰ΩúË¶ÅÂµåÂÖ•base64Ëß£ÂØÜÈáåÈù¢,ÂÖ∂ÂÆûÂÖàÂºÇÊàñÂ∞±ÂæóÂà∞Ê≤°ÊúâÈ≠îÊîπÁöÑÂ≠óÁ¨¶‰∏≤‰∫Ü</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="title function_">base64_magic</span><span class="params">(<span class="type">long</span> param_1)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">long</span> len;</span><br><span class="line">  <span class="type">long</span> enc2;</span><br><span class="line">  <span class="type">int</span> local_20;</span><br><span class="line">  <span class="type">int</span> i;</span><br><span class="line">  <span class="type">long</span> final_len;</span><br><span class="line">  </span><br><span class="line">  len = ::len(param_1);</span><br><span class="line">  <span class="keyword">if</span> (len % <span class="number">3</span> == <span class="number">0</span>) &#123;</span><br><span class="line">    final_len = len / <span class="number">3</span> &lt;&lt; <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    final_len = (len / <span class="number">3</span> + <span class="number">1</span>) * <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">                      <span class="comment">/* Áî≥ËØ∑Á©∫Èó¥? */</span></span><br><span class="line">  enc2 = FUN_00021fc6(final_len + <span class="number">1</span>);</span><br><span class="line">  *(undefined *)(final_len + enc2) = <span class="number">0</span>;</span><br><span class="line">  local_20 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; (<span class="type">long</span>)i &lt; final_len + <span class="number">-2</span>; i = i + <span class="number">4</span>) &#123;</span><br><span class="line">    *(byte *)(i + enc2) =</span><br><span class="line">          <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ9876543210+/&quot;</span></span><br><span class="line">          [(<span class="type">int</span>)(uint)(*(byte *)(local_20 + param_1) &gt;&gt; <span class="number">2</span>)] ^ <span class="number">0x11</span>;</span><br><span class="line">    *(byte *)((<span class="type">long</span>)i + <span class="number">1</span> + enc2) =</span><br><span class="line">          <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ9876543210+/&quot;</span></span><br><span class="line">          [(<span class="type">int</span>)((uint)(*(byte *)((<span class="type">long</span>)local_20 + <span class="number">1</span> + param_1) &gt;&gt; <span class="number">4</span>) |</span><br><span class="line">                (*(byte *)(local_20 + param_1) &amp; <span class="number">3</span>) &lt;&lt; <span class="number">4</span>)] ^ <span class="number">0x22</span>;</span><br><span class="line">    *(byte *)((<span class="type">long</span>)i + <span class="number">2</span> + enc2) =</span><br><span class="line">          <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ9876543210+/&quot;</span></span><br><span class="line">          [(<span class="type">int</span>)((uint)(*(byte *)((<span class="type">long</span>)local_20 + <span class="number">2</span> + param_1) &gt;&gt; <span class="number">6</span>) |</span><br><span class="line">                (*(byte *)((<span class="type">long</span>)local_20 + <span class="number">1</span> + param_1) &amp; <span class="number">0xf</span>) &lt;&lt; <span class="number">2</span>)] ^ <span class="number">0x33</span>;</span><br><span class="line">    *(byte *)((<span class="type">long</span>)i + <span class="number">3</span> + enc2) =</span><br><span class="line">          <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ9876543210+/&quot;</span></span><br><span class="line">          [(ulong)*(byte *)((<span class="type">long</span>)local_20 + <span class="number">2</span> + param_1) &amp; <span class="number">0x3f</span>] ^ <span class="number">0x44</span>;</span><br><span class="line">    local_20 = local_20 + <span class="number">3</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (len % <span class="number">3</span> == <span class="number">1</span>) &#123;</span><br><span class="line">    *(undefined *)((<span class="type">long</span>)i + <span class="number">-2</span> + enc2) = <span class="string">&#x27;h&#x27;</span>;</span><br><span class="line">    *(undefined *)((<span class="type">long</span>)i + <span class="number">-1</span> + enc2) = <span class="string">&#x27;h&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (len % <span class="number">3</span> == <span class="number">2</span>) &#123;</span><br><span class="line">    *(undefined *)((<span class="type">long</span>)i + <span class="number">-1</span> + enc2) = <span class="string">&#x27;h&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> enc2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h1><p>ÂÜôËÑöÊú¨Êó∂Èó¥~</p>
<p>‰ªéFUN_00023c82ÂæóÁü•Ë¶ÅÊØîËæÉÁöÑÊòØ,Âõ†Ê≠§ÂÖàËøõË°åbaseÈ≠îÊîπËß£ÂØÜ,Ê≥®ÊÑèËß£ÂØÜÁªÜËäÇ(ÂºÇÊàñÊó∂‰∏çË¶ÅÂºÇÊàñÊéâÂ°´ÂÖÖÁ¨¶),ÂæóÂà∞dec1</p>
<p><img src="/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/3.png" loading="lazy"></p>
<p><img src="/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/4.png" loading="lazy"></p>
<h3 id="ÁàÜÁ†¥Áü©Èòµ"><a href="#ÁàÜÁ†¥Áü©Èòµ" class="headerlink" title="ÁàÜÁ†¥Áü©Èòµ"></a>ÁàÜÁ†¥Áü©Èòµ</h3><p>ËøôÊ¨°Êó∂Èó¥‰∏ªË¶ÅËä±Âú®‰∫ÜËß£Áü©ÈòµËøôÈáå ‡Æá‡Ø∞‡Æá ÊàëÂè™ÊÉ≥Âà∞‰∫ÜÁ∫ø‰ª£ÁöÑÂü∫Êú¨Áü©Èòµ‰πòÊ≥ï,‰ΩÜÊòØÁªìÊûúÊòØË¢´Ê®°Èô§ËøáÁöÑ,ÊâÄ‰ª•Âè™Áü•ÈÅì‰ΩôÊï∞‰∏çÁü•ÈÅìÂïÜ,ËøôÁßçÊÉÖÂÜµ‰∏çËÉΩÁÆÄÂçïÁöÑkeyÊ±ÇÈÄÜÂÜç‰πò‰ª•dec1,z3‰πüË∑ë‰∏çÂá∫Êù•,ËøôÊó∂ÂÄôÂ∞±Âè™ÊúâÊÉ≥Âà∞ÁàÜÁ†¥‰∫Ü</p>
<p>Ê†πÊçÆÁü©Èòµ‰πòÊ≥ïÂéüÁêÜ,ÊØèÊ¨°ÁàÜÁ†¥inputÁöÑ‰∏ÄÂàó,‰ΩÜÊòØÊó∂Èó¥Êúâ‰∏ÄÁÇπ‰πÖ,‰∏ÄÂàóÂ∞±ÊòØ$(126-32)^4$, ÈÇ£Â∞±Áåú‰∏Ä‰∏ã,ÂâçÈù¢‰∫î‰∏™Â∞±ÊòØ<code>flag&#123;</code>,ÊúÄÂêéÊòØ<code>&#125;</code> ,Ëøô‰πüÂ∞ë‰∫Ü‰∏Ä‰∏™Êï∞ÈáèÁ∫ß‰∫Ü</p>
<p>ÁÑ∂ÂêéÊ≤°ÊúâÂÜôÂÆåÊï¥ÁöÑËÑöÊú¨,Âú®Âü∫Á°ÄËÑöÊú¨ÈáåÈù¢ÊîπjÁöÑÂÄºÂíåaÁöÑÂÄºÂ∞±Â•Ω‰∫Ü</p>
<h3 id="Ê≠£ËßÑÂÜõÂÅöÊ≥ï"><a href="#Ê≠£ËßÑÂÜõÂÅöÊ≥ï" class="headerlink" title="Ê≠£ËßÑÂÜõÂÅöÊ≥ï"></a>Ê≠£ËßÑÂÜõÂÅöÊ≥ï</h3><p>Ë∑üÂ≠¶Èïø‰∫§ÊµÅÊâçÁü•ÈÅìËøô‰∏™Âè´ÊúâÈôêÂüüÁü©Èòµ‰πòÊ≥ï,ÊúâÈôêÂüüÂ∞±ÊòØ0x101‰∫Ü,‰∏äÁΩëÊü•ÁÇπËµÑÊñôÂ∞±ËÉΩÂÅö</p>
<h1 id="Getflag"><a href="#Getflag" class="headerlink" title="Getflag"></a>Getflag</h1><table>
<thead>
<tr>
<th>f</th>
<th>l</th>
<th>a</th>
<th>g</th>
<th>{</th>
</tr>
</thead>
<tbody><tr>
<td>f</td>
<td>o</td>
<td>r</td>
<td>_</td>
<td>t</td>
</tr>
<tr>
<td>h</td>
<td>e</td>
<td>_</td>
<td>1</td>
<td>i</td>
</tr>
<tr>
<td>c</td>
<td>h</td>
<td>_</td>
<td>k</td>
<td>i</td>
</tr>
<tr>
<td>n</td>
<td>g</td>
<td>!</td>
<td>!</td>
<td>}</td>
</tr>
</tbody></table>
<p>flag{for_the_1ich_king!!}</p>
<h1 id="‰∏Ä‰∫õÂ§áÂøò"><a href="#‰∏Ä‰∫õÂ§áÂøò" class="headerlink" title="‰∏Ä‰∫õÂ§áÂøò"></a>‰∏Ä‰∫õÂ§áÂøò</h1><p>input: 1234567891234567891234567</p>
<p><img src="/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/5.png" alt="input 0x40007ffd80" loading="lazy"></p>
<p>input 0x40007ffd80</p>
<p><img src="/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/6.png" alt="enc1 0x40007ffd30" loading="lazy"></p>
<p>enc1 0x40007ffd30</p>
<p>FUN_000241f8ÈúÄË¶ÅÊ≥®ÊÑè:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">uVar4(a0)</span><br><span class="line">	uVar4 = -(long)input &amp; 7;</span><br><span class="line">	<span class="keyword">if</span> (uVar4 != 0)</span><br><span class="line">uVar3(s1)</span><br></pre></td></tr></table></figure>

<p>FUN_0002428c</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">value(a2)</span><br><span class="line">	switch(value &amp; 7)</span><br><span class="line">	Êõ¥Êñ∞</span><br></pre></td></tr></table></figure>
</article>
    
    
</div>
<div id="post-next-prev" class="row">
    <div class="col-lg-12">
        <!-- title -->
        <h5 class="trm-title-with-divider">
            Other Articles
            <span data-number="02"></span>
        </h5>
    </div>
    
    
        <div class="col-lg-6">
            <div class="trm-blog-card trm-scroll-animation" data-scroll data-scroll-offset="40">
    <a href="/2022/09/18/Hello-World-0/" class="trm-cover-frame trm-anima-link">
        
        
            <img alt="cover" class="no-fancybox" src="/img/block.jpg">
        
    </a>
    <div class="trm-card-descr">
        <div class="trm-label trm-category trm-mb-20">
            <a href=" #.">
                Unclassified
            </a>
        </div>
        <h5>
            <a href="/2022/09/18/Hello-World-0/" class="trm-anima-link">
                Hello World!
            </a>
        </h5>
        <div class="trm-divider trm-mb-20 trm-mt-20"></div>
        <ul class="trm-card-data trm-label">
            <li>22/09/18</li>
            <li>22:53</li>
            
            
        </ul>
    </div>
</div>
        </div>
    
</div>

    



                    <div class="trm-divider footer-divider"></div>

                    <!-- footer -->
                    <footer class="trm-scroll-animation" data-scroll data-scroll-offset="50">

    

    

    
        <div class="trm-footer-item">
            <span>
                Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> v6.3.0
            </span>
            <span class="footer-separator" data-separator=" | "></span>
            <span> 
                Theme - 
                <a rel="noopener" href='https://github.com/MaLuns/hexo-theme-async' target='_blank'>Async</a>
                v0.0.0
            </span>
        </div>
      

    
        <div class="trm-footer-item">
            The blog has been lovely to run <span id="since" class="trm-accent-color"></span> day
        </div>
     

    
        <div class="trm-footer-item">
            hahahahahaharik
        </div>
     
</footer>

<script>
    function show_date_time () {
        BirthDay = new Date("01/11/2023 1:11:00");
        today = new Date();
        timeold = (today.getTime() - BirthDay.getTime());
        msPerDay = 24 * 60 * 60 * 1000
        day = Math.floor(timeold / msPerDay)
        since.innerHTML = day
    }
    show_date_time()
</script>
 
                    <!-- footer end -->

                </div>
            </div>
        </div>
    </div>
</div>
            <!-- body end -->

            <!-- body -->
            <div class="trm-fixed-container" data-scroll data-scroll-sticky data-scroll-target=".locomotive-scroll__sticky-target" data-scroll-offset="-10">
    
        <div class="trm-fixed-btn" data-title="Read Mode" onclick="switchReadMode()">
            <i class="iconfont fas fa-book-reader"></i>
        </div>
    
    
        <div class="trm-fixed-btn" data-title="Toggle between single-column and double-column" onclick="document.body.classList.toggle('trm-single-column')">
            <i class="iconfont fas fa-arrows-alt-h"></i>
        </div>
    
</div>
            <!-- body end -->
          </div>
        </div>
      </div>
      <!-- scroll container end -->

  </div>
  <!-- app wrapper end -->

  <div id="trm-back-top" class="trm-back-top" data-title="Back To Top">
    <i class="iconfont fas fa-arrow-up"></i>
</div>
  
<div class="trm-search-popup">
    <div class="trm-search-header">
        <span class="trm-search-popup-btn-close">
            <i class="iconfont fas fa-times"></i>
        </span>
    </div>
    <div class="form trm-search-form">
        <input class="trm-search-input" type="text" placeholder="Searching...">
    </div>
    <div class="trm-search-result-container">

    </div>
</div>

  <!-- Plugin -->



    
    

    
<script src="https://unpkg.com/locomotive-scroll@4.1.4/dist/locomotive-scroll.min.js"></script>

    
<script src="https://unpkg.com/@fancyapps/ui@4.0/dist/fancybox.umd.js"></script>


    

    

    

    <!-- Êï∞Â≠¶ÂÖ¨Âºè -->
    


    <!-- ËØÑËÆ∫Êèí‰ª∂ -->
    
        
        
    



<!-- CDN -->


    

    

    




    <!-- Service Worker -->
    
    <!-- baidu push -->
    


<script id="async-script" src="/js/main.js?v=0.0.0"></script>

</body>

</html>