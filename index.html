<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>(æ–½å·¥ä¸­...é—²äººå…è¿›...)Hur1kçš„å°å°çªå•Š( â€¢Ì€ Ï‰ â€¢Ì )âœ§</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="(æ–½å·¥ä¸­...é—²äººå…è¿›...)çƒ­ä¹ç€å‘¢,å¿«æ¥åå~">
<meta property="og:type" content="website">
<meta property="og:title" content="(æ–½å·¥ä¸­...é—²äººå…è¿›...)Hur1kçš„å°å°çªå•Š( â€¢Ì€ Ï‰ â€¢Ì )âœ§">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="(æ–½å·¥ä¸­...é—²äººå…è¿›...)Hur1kçš„å°å°çªå•Š( â€¢Ì€ Ï‰ â€¢Ì )âœ§">
<meta property="og:description" content="(æ–½å·¥ä¸­...é—²äººå…è¿›...)çƒ­ä¹ç€å‘¢,å¿«æ¥åå~">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Hur1k">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="(æ–½å·¥ä¸­...é—²äººå…è¿›...)Hur1kçš„å°å°çªå•Š( â€¢Ì€ Ï‰ â€¢Ì )âœ§" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">(æ–½å·¥ä¸­...é—²äººå…è¿›...)Hur1kçš„å°å°çªå•Š( â€¢Ì€ Ï‰ â€¢Ì )âœ§</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-TEST" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/11/19/TEST/" class="article-date">
  <time class="dt-published" datetime="2022-11-18T16:47:44.000Z" itemprop="datePublished">2022-11-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/11/19/TEST/">XSCTFå†³èµ›-é˜²AK-writeup</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>ç¬¬ä¸€ç¯‡WP (â•¹Ú¡â•¹ )</p>
<p>ä»å†³èµ›åˆ°ç°åœ¨å¤§æ¦‚æ˜¯2å‘¨çš„æ—¶é—´,ç»ˆäºç®—æ˜¯åšå®Œäº†ğŸ˜­</p>
<p>Ghidraç«Ÿç„¶èƒ½æ‰“å¼€!!è™½ç„¶åç¼–è¯‘å±‚ä¹Ÿæ˜¯æœ‰ç‚¹éš¾,åšå®Œåå‘ç°å…¶å®åŠ å¯†æ“ä½œä¸ç®—éš¾,åªæ˜¯æ¶æ„é—®é¢˜æŠŠå¾ˆå¤šæ“ä½œéƒ½å¤æ‚åŒ–äº†</p>
<p>è™½ç„¶èŠ±çš„æ—¶é—´æ¯”è¾ƒä¹…,ä½†æ€»çš„æ¥è¯´æ”¶è·è¿˜æ˜¯æŒºå¤§çš„,ä»¥å‰ä¸€ç›´ä¾èµ–ç€è´µå¦‡å¤´çš„åŠ¨è°ƒå·¥å…·,å¾ˆå°‘ç”¨åˆ°åªæœ‰åæ±‡ç¼–æ²¡æœ‰åç¼–è¯‘çš„å·¥å…·å¦‚gdb(gdbéƒ½ä¸ä¼šç”¨!è¯¥æ‰“!),å¦å¤–ä¹Ÿç»ƒä¹ äº†ä¸€ä¸‹çŸ©é˜µç±»çš„é¢˜ç›®,ç›¸å…³åº“(numpy,sympy)çš„ä½¿ç”¨,ç»§ç»­åŠ æ²¹~</p>
<h1 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#çˆ†ç ´è„šæœ¬</span></span><br><span class="line"></span><br><span class="line">enc = [<span class="number">0x23</span>, <span class="number">0x58</span>, <span class="number">0x64</span>, <span class="number">0x0c</span>, <span class="number">0x3a</span>, <span class="number">0x6a</span>, <span class="number">0x7c</span>, <span class="number">0x09</span>, <span class="number">0x65</span>, <span class="number">0x65</span>, <span class="number">0x02</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x7a</span>, <span class="number">0x4a</span>, <span class="number">0x10</span>, <span class="number">0x3e</span>, <span class="number">0x1a</span>, <span class="number">0x45</span>, <span class="number">0x01</span>,</span><br><span class="line">    <span class="number">0x3a</span>, <span class="number">0x09</span>, <span class="number">0x02</span>, <span class="number">0x72</span>, <span class="number">0x3e</span>, <span class="number">0x15</span>, <span class="number">0x74</span>, <span class="number">0x0b</span>, <span class="number">0x25</span>, <span class="number">0x55</span>, <span class="number">0x03</span>, <span class="number">0x35</span>, <span class="number">0x60</span>, <span class="number">0x75</span>, <span class="number">0x68</span>, <span class="number">0x68</span>]</span><br><span class="line">xor_list=[<span class="number">0x11</span>,<span class="number">0x22</span>,<span class="number">0x33</span>,<span class="number">0x44</span>]</span><br><span class="line">fakekey=<span class="string">&#x27;flag&#123;No!I_am_not_the_key&#125;&#x27;</span></span><br><span class="line">fakekey=<span class="built_in">list</span>(fakekey.encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">b64Magic</span>(<span class="params">magicDic,plaintext</span>):</span><br><span class="line">    <span class="keyword">import</span> base64</span><br><span class="line">    str1=plaintext</span><br><span class="line">    string1=magicDic</span><br><span class="line">    string2 = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">    <span class="built_in">print</span> (base64.b64decode(str1.translate(<span class="built_in">str</span>.maketrans(string1,string2))))</span><br><span class="line">    <span class="keyword">return</span> base64.b64decode(str1.translate(<span class="built_in">str</span>.maketrans(string1,string2)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix_line_mul</span>(<span class="params">line,i</span>):</span><br><span class="line">    tmp=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        tmp+=(fakekey[k+i*<span class="number">5</span>]*line[k])</span><br><span class="line">    <span class="keyword">return</span> tmp%<span class="number">0x101</span></span><br><span class="line">            </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)-<span class="number">2</span>):</span><br><span class="line">        enc[i]^=xor_list[i%<span class="number">4</span>]</span><br><span class="line">    enc[-<span class="number">1</span>]=<span class="built_in">ord</span>(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">    enc[-<span class="number">2</span>]=<span class="built_in">ord</span>(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytes</span>(enc))</span><br><span class="line">    magicDic=<span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ9876543210+/&#x27;</span></span><br><span class="line">    dec1=<span class="built_in">list</span>(b64Magic(magicDic,<span class="built_in">bytes</span>(enc).decode()))</span><br><span class="line">    </span><br><span class="line">    ans=[]</span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">    j=<span class="number">2</span> <span class="comment">#æ”¹è¿™</span></span><br><span class="line">    a=<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) <span class="comment">#æ”¹è¿™</span></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">            <span class="keyword">if</span> c%<span class="number">10</span>==<span class="number">0</span>: <span class="comment">#ç›‘è§†è¿›åº¦(å®‰å…¨æ„Ÿ)</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;b:<span class="subst">&#123;<span class="built_in">chr</span>(b)&#125;</span> c:<span class="subst">&#123;<span class="built_in">chr</span>(c)&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">                <span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">                    data=[a,b,c,d,e]</span><br><span class="line">                    <span class="comment"># print(matrix_line_mul(data,0))</span></span><br><span class="line">                    <span class="keyword">if</span> matrix_line_mul(data,<span class="number">0</span>) == dec1[<span class="number">0</span>*<span class="number">5</span>+j]:</span><br><span class="line">                        <span class="keyword">if</span> matrix_line_mul(data,<span class="number">1</span>) == dec1[<span class="number">1</span>*<span class="number">5</span>+j]:</span><br><span class="line">                            <span class="keyword">if</span> matrix_line_mul(data,<span class="number">2</span>) == dec1[<span class="number">2</span>*<span class="number">5</span>+j]:</span><br><span class="line">                                <span class="keyword">if</span> matrix_line_mul(data,<span class="number">3</span>) == dec1[<span class="number">3</span>*<span class="number">5</span>+j]:</span><br><span class="line">                                    <span class="keyword">if</span> matrix_line_mul(data,<span class="number">4</span>) == dec1[<span class="number">4</span>*<span class="number">5</span>+j]:</span><br><span class="line">                                        <span class="built_in">print</span>(<span class="string">f&quot;Found! <span class="subst">&#123;data&#125;</span> <span class="subst">&#123;<span class="built_in">bytes</span>(data)&#125;</span>&quot;</span>)</span><br><span class="line">                                        <span class="built_in">breakpoint</span>()</span><br><span class="line">                                        ans.append(data)</span><br><span class="line">    <span class="built_in">print</span>(ans)</span><br><span class="line">main()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ­£è§„å†›è„šæœ¬,ç”¨åˆ°äº†sympy</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line">np.set_printoptions(suppress=<span class="literal">True</span>) <span class="comment">#ä¸ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•</span></span><br><span class="line"></span><br><span class="line">enc = [<span class="number">0x23</span>, <span class="number">0x58</span>, <span class="number">0x64</span>, <span class="number">0x0c</span>, <span class="number">0x3a</span>, <span class="number">0x6a</span>, <span class="number">0x7c</span>, <span class="number">0x09</span>, <span class="number">0x65</span>, <span class="number">0x65</span>, <span class="number">0x02</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x7a</span>, <span class="number">0x4a</span>, <span class="number">0x10</span>, <span class="number">0x3e</span>, <span class="number">0x1a</span>, <span class="number">0x45</span>, <span class="number">0x01</span>,</span><br><span class="line">    <span class="number">0x3a</span>, <span class="number">0x09</span>, <span class="number">0x02</span>, <span class="number">0x72</span>, <span class="number">0x3e</span>, <span class="number">0x15</span>, <span class="number">0x74</span>, <span class="number">0x0b</span>, <span class="number">0x25</span>, <span class="number">0x55</span>, <span class="number">0x03</span>, <span class="number">0x35</span>, <span class="number">0x60</span>, <span class="number">0x75</span>, <span class="number">0x68</span>, <span class="number">0x68</span>]</span><br><span class="line">xor_list=[<span class="number">0x11</span>,<span class="number">0x22</span>,<span class="number">0x33</span>,<span class="number">0x44</span>]</span><br><span class="line"></span><br><span class="line">enc1=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">b64Magic</span>(<span class="params">magicDic,plaintext</span>):</span><br><span class="line">    <span class="keyword">import</span> base64</span><br><span class="line">    str1=plaintext</span><br><span class="line">    string1=magicDic</span><br><span class="line">    string2 = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">    <span class="built_in">print</span> (base64.b64decode(str1.translate(<span class="built_in">str</span>.maketrans(string1,string2))))</span><br><span class="line">    <span class="keyword">return</span> base64.b64decode(str1.translate(<span class="built_in">str</span>.maketrans(string1,string2)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    fakekey=<span class="string">&#x27;flag&#123;No!I_am_not_the_key&#125;&#x27;</span></span><br><span class="line">    fakekey=<span class="built_in">list</span>(fakekey.encode())</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)-<span class="number">2</span>):</span><br><span class="line">        enc[i]^=xor_list[i%<span class="number">4</span>]</span><br><span class="line">    enc[-<span class="number">1</span>]=<span class="built_in">ord</span>(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">    enc[-<span class="number">2</span>]=<span class="built_in">ord</span>(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytes</span>(enc))</span><br><span class="line">    magicDic=<span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ9876543210+/&#x27;</span></span><br><span class="line">    dec1=<span class="built_in">list</span>(b64Magic(magicDic,<span class="built_in">bytes</span>(enc).decode()))</span><br><span class="line">   </span><br><span class="line">    fakekey=sympy.Matrix(fakekey).reshape(<span class="number">5</span>,<span class="number">5</span>)</span><br><span class="line">    dec1=sympy.Matrix(dec1).reshape(<span class="number">5</span>,<span class="number">5</span>)</span><br><span class="line">    fakekey_inv=fakekey.inv_mod(<span class="number">0x101</span>)</span><br><span class="line">    flag=fakekey_inv*dec1%<span class="number">0x101</span></span><br><span class="line">    sympy.pprint(flag)</span><br><span class="line">main()</span><br></pre></td></tr></table></figure>

<h1 id="çœæµ"><a href="#çœæµ" class="headerlink" title="çœæµ"></a>çœæµ</h1><p>æœ‰é™åŸŸçŸ©é˜µä¹˜æ³•+å¤åˆ¶æ“ä½œ+base64é­”æ”¹(æ¢è¡¨+å¼‚æˆ–)</p>
<h1 id="ä¸€äº›ç§¯ç´¯"><a href="#ä¸€äº›ç§¯ç´¯" class="headerlink" title="ä¸€äº›ç§¯ç´¯"></a>ä¸€äº›ç§¯ç´¯</h1><p><code>x &amp; p</code> å…¶ä¸­pä¸ºå½¢å¦‚0b1, 0b11, 0b111,é‚£ä¹ˆæ•ˆæœç›¸å½“äº<code>x % (p+1)</code></p>
<h3 id="Riscvå¯„å­˜å™¨"><a href="#Riscvå¯„å­˜å™¨" class="headerlink" title="Riscvå¯„å­˜å™¨"></a>Riscvå¯„å­˜å™¨</h3><p>å¦å¤–æ³¨æ„riscvå’Œi386çš„ä¸åŒ</p>
<p><code>x8/s0/fp</code> saved register ã€frame pointer</p>
<p><code>x10 / a0</code> (function argument, return value)</p>
<p><code>x11 / a1</code>(function argument, return value)</p>
<p><code>x18 / s2</code> (saved register)</p>
<ul>
<li><p>å¯„å­˜å™¨</p>
<p>  <img src="/2022/11/19/TEST/1.png"></p>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://lab.cs.tsinghua.edu.cn/cod-lab-docs/labs/4-riscv-inst/">RISC-V æŒ‡ä»¤æ¦‚å†µ</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/George-Okelly1995/p/9801357.html">[è®¡ç®—æœºç¡¬ä»¶] RISC-V æ±‡ç¼–æŒ‡ä»¤ç¬”è®°</a></p>
<p>æ„Ÿè§‰æ›´å…¨ä¸€ç‚¹</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/558799873">è®¡åŸº(äºŒ)RISC-VæŒ‡ä»¤é›†ä»‹ç»ä¸æ±‡ç¼–</a></p>
<h1 id="è¿è¡Œ-åŠ¨è°ƒ"><a href="#è¿è¡Œ-åŠ¨è°ƒ" class="headerlink" title="è¿è¡Œ+åŠ¨è°ƒ"></a>è¿è¡Œ+åŠ¨è°ƒ</h1><blockquote>
<p>æ€»ç»“äº†ä¸€ä¸‹ä¸åŒæ¶æ„çš„è¿è¡ŒåŠ åŠ¨è°ƒæ–¹æ³•,ç‰¹åˆ«æ„Ÿè°¢å¤§ä½¬stdlibhæ•™æˆ‘é…ç¯å¢ƒğŸ˜­</p>
</blockquote>
<h2 id="ç›¸å…³å·¥å…·"><a href="#ç›¸å…³å·¥å…·" class="headerlink" title="ç›¸å…³å·¥å…·"></a>ç›¸å…³å·¥å…·</h2><blockquote>
<p>åªæ˜¯åˆ—ä¸¾äº†ä¸€ä¸‹,å®é™…ä¸Šæ²¡ç”¨åˆ°é‚£ä¹ˆå¤š</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install qemu qemu-user qemu-user-static gdb gdb-multiarch <span class="string">&#x27;binfmt*&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>qemuç³»ç»Ÿæ€</li>
<li>qemu-user-staticç”¨æˆ·æ€(staticä¸çŸ¥é“å•¥)</li>
<li>gdb</li>
<li>gdb-multiarch</li>
<li>binfmtå¯ä»¥ä½¿ç”¨è¯¥åŒ…æŸ¥çœ‹æ–‡ä»¶çš„ç±»å‹,å¹¶è‡ªåŠ¨è°ƒç”¨æ­£ç¡®çš„è§£é‡Šå™¨.</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…gdbæ’ä»¶pwndbg(æˆ–è€…gefç­‰æ”¯æŒå¤šæ¶æ„çš„æ’ä»¶)</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/pwndbg/pwndbg</span><br><span class="line"><span class="built_in">cd</span> pwndbg</span><br><span class="line">./setup.sh</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…riscv-gnu-toolchain</span></span><br><span class="line"><span class="comment"># https://github.com/riscv-collab/riscv-gnu-toolchain</span></span><br><span class="line"><span class="comment"># ç›´æ¥åœ¨Releaseä¸­æ‰¾å¯¹åº”çš„å‹ç¼©åŒ…ä¸‹è½½å³å¯</span></span><br><span class="line">riscv64-elf-ubuntu-20.04-nightly-2022.11.12-nightly.tar.gz</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="é™æ€é“¾æ¥è¿è¡Œ"><a href="#é™æ€é“¾æ¥è¿è¡Œ" class="headerlink" title="é™æ€é“¾æ¥è¿è¡Œ"></a>é™æ€é“¾æ¥è¿è¡Œ</h2><h3 id="æ–¹æ³•1"><a href="#æ–¹æ³•1" class="headerlink" title="æ–¹æ³•1"></a>æ–¹æ³•1</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">file ./arch</span><br><span class="line">./arch</span><br></pre></td></tr></table></figure>

<ul>
<li><p>å…ˆfileæŸ¥çœ‹æ–‡ä»¶ç±»å‹,è¿™é‡Œarchæ˜¯æ–‡ä»¶å,ä»¥åŠé“¾æ¥æ–¹æ³•</p>
</li>
<li><p>è¿™æ—¶å€™å¯ä»¥ç›´æ¥è¿è¡Œ</p>
<p>  åŸå› (<a target="_blank" rel="noopener" href="https://danielmangum.com/posts/risc-v-bytes-qemu-gdb/">å‚è€ƒ</a>):linuxå†…æ ¸æ”¯æŒä¸€ä¸ªç‰¹æ€§:binfmt_misc, å…è®¸ä¸ºæŒ‡å®šçš„äºŒè¿›åˆ¶ç±»å‹è‡ªåŠ¨æ³¨å†Œå’Œè°ƒç”¨è§£é‡Šå™¨,å®‰è£…äº†qemuåå®ƒå°±å¯ä»¥ç”¨äº†,å¯ä»¥<code>ls /proc/sys/fs/binfmt_misc/</code> æŸ¥çœ‹è¯¦æƒ…</p>
</li>
</ul>
<h3 id="æ–¹æ³•2-å‚è€ƒ"><a href="#æ–¹æ³•2-å‚è€ƒ" class="headerlink" title="æ–¹æ³•2(å‚è€ƒ)"></a>æ–¹æ³•2(<a target="_blank" rel="noopener" href="https://blog.csdn.net/Homewm/article/details/103574535">å‚è€ƒ</a>)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> /usr/bin/qemu-riscv-static ./</span><br><span class="line">sudo <span class="built_in">chroot</span> . ./qemu-riscv-static ./arch</span><br></pre></td></tr></table></figure>

<ul>
<li>cpä¹Ÿå¯ä»¥å†™ä¸º<code>cp which qemu-mips-static ./</code></li>
<li><code>sudo chroot .</code>  å¯ä»¥ä¸å†™</li>
<li>è¿™ç§å±äºç›´æ¥æŠŠç›¸åº”çš„è¿è¡Œå™¨æ‹‰å‡ºæ¥ä½¿ç”¨</li>
</ul>
<h2 id="åŠ¨æ€é“¾æ¥è¿è¡Œ-è¿˜æ²¡è¯•è¿‡"><a href="#åŠ¨æ€é“¾æ¥è¿è¡Œ-è¿˜æ²¡è¯•è¿‡" class="headerlink" title="åŠ¨æ€é“¾æ¥è¿è¡Œ(è¿˜æ²¡è¯•è¿‡)"></a>åŠ¨æ€é“¾æ¥è¿è¡Œ(è¿˜æ²¡è¯•è¿‡)</h2><h3 id="å®‰è£…å…±äº«åº“-å‚è€ƒ"><a href="#å®‰è£…å…±äº«åº“-å‚è€ƒ" class="headerlink" title="å®‰è£…å…±äº«åº“(å‚è€ƒ)"></a>å®‰è£…å…±äº«åº“(<a target="_blank" rel="noopener" href="https://www.cnblogs.com/WangAoBo/p/debug-arm-mips-on-linux.html">å‚è€ƒ</a>)</h3><p><code>apt-cache search &quot;libc6&quot; | grep riscv</code></p>
<p>ç„¶åå®‰è£…å¯¹åº”çš„åº“å³å¯</p>
<h3 id="æŒ‡å®šå…±äº«åº“"><a href="#æŒ‡å®šå…±äº«åº“" class="headerlink" title="æŒ‡å®šå…±äº«åº“"></a>æŒ‡å®šå…±äº«åº“</h3><p><code>qemu-mipsel -L /usr/mipsel-linux-gnu/ ./arch</code></p>
<ul>
<li>æ³¨æ„:ä»…ä¸ºç¤ºä¾‹ä»£ç </li>
<li>ç¬¬ä¸€ä¸ªæ˜¯è¿è¡Œå™¨,-LæŒ‡å®šå…±äº«åº“</li>
</ul>
<h2 id="åŠ¨æ€è°ƒè¯•"><a href="#åŠ¨æ€è°ƒè¯•" class="headerlink" title="åŠ¨æ€è°ƒè¯•"></a>åŠ¨æ€è°ƒè¯•</h2><h3 id="å°è¯•ä¸€"><a href="#å°è¯•ä¸€" class="headerlink" title="å°è¯•ä¸€"></a>å°è¯•ä¸€</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">qemu-mipsel -g 1234 -L /usr/mipsel-linux-gnu/ ./arch</span><br><span class="line">gdb-multiarch</span><br><span class="line"><span class="built_in">set</span> architecture mips</span><br><span class="line">target remote localhost:1234</span><br></pre></td></tr></table></figure>

<ul>
<li>ç¤ºä¾‹ä»£ç ,-gæŒ‡å®šç«¯å£</li>
<li>ä½¿ç”¨gdb-multiarchè¿›è¡Œè°ƒè¯•,è®¾ç½®å¥½æ¶æ„(tabæŸ¥çœ‹è¯¦æƒ…,ä¹Ÿå¯ä»¥è®¾ç½®ä¸ºauto)</li>
<li>æŒ‡å®šè°ƒè¯•çš„ç›®æ ‡ç«¯å£ä½ç½®</li>
<li><strong>ç„¶åè¿™é“é¢˜æˆ‘ç”¨è¿™ä¸ªæ–¹æ³•ä¸æˆåŠŸ</strong></li>
</ul>
<h3 id="å°è¯•äºŒ"><a href="#å°è¯•äºŒ" class="headerlink" title="å°è¯•äºŒ"></a>å°è¯•äºŒ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo qemu-riscv64 -g 9999 <span class="built_in">arch</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo ./riscv64-unknown-elf-gdb</span><br><span class="line">file <span class="built_in">arch</span>     <span class="comment">#(No debugging symbols found in arch)</span></span><br><span class="line">targe remote :9999</span><br></pre></td></tr></table></figure>

<ul>
<li>ä¸€ä¸ªçª—å£å¼€gdbserver,ä¸€ä¸ªæ§åˆ¶gdb</li>
<li><strong>sudoè¦åŠ ä¸Š,ä¸çŸ¥é“ä¸ºå•¥æˆ‘ä¸åŠ å°±åŠ¨è°ƒä¸äº†</strong></li>
<li>åœ¨bashä¸­fileçš„æ—¶å€™è¯´<strong>stripped</strong>,æ‰€ä»¥æ²¡æœ‰ç¬¦å·ä¿¡æ¯,è¿™æ—¶å€™gdbåªèƒ½æ§åˆ¶continue,ä¸èƒ½ç›´æ¥ä¸‹æ–­ç‚¹,å•æ­¥æ“ä½œç­‰,æ‰€ä»¥è°ƒè¯•å˜å¾—éå¸¸éº»çƒ¦,å½“æ—¶åªèƒ½ç»™åœ°å€ä¸‹æ–­ç‚¹å¦‚<code>b *0x10dbe</code> ,<strong>ä½†æ˜¯æˆ‘è§‰å¾—è¿™ç§æƒ…å†µåº”è¯¥è¿˜æ˜¯å¯ä»¥å•æ­¥è°ƒè¯•çš„,å¸Œæœ›æœ‰å¤§ä½¬èƒ½è§£ç­”ä¸€ä¸‹æ–¹æ³•</strong></li>
</ul>
<p>ç„¶åå°±å¯ä»¥æ„‰å¿«çš„åšé¢˜å•¦ğŸ˜</p>
<h1 id="Hacking1-æœ‰é™åŸŸçŸ©é˜µä¹˜æ³•"><a href="#Hacking1-æœ‰é™åŸŸçŸ©é˜µä¹˜æ³•" class="headerlink" title="Hacking1-æœ‰é™åŸŸçŸ©é˜µä¹˜æ³•"></a>Hacking1-æœ‰é™åŸŸçŸ©é˜µä¹˜æ³•</h1><p>ä¸€å¼€å§‹ä¸€ç›´åœ¨çº ç»“IDAæ€ä¹ˆæ‰“å¼€,æ‰“å¼€ååˆä¸èƒ½åŠ¨è°ƒä¸èƒ½åç¼–è¯‘,åé¢æŠ˜è…¾ç¯å¢ƒå»äº†,å†³èµ›ç»“æŸ</p>
<p>ç»æç‚¹ç”¨Ghidraæ‰“å¼€,å‘ç°æ–°ä¸–ç•ŒğŸ˜­</p>
<p>å…ˆçœ‹main_funcçš„é€»è¾‘:è·å–è¾“å…¥â†’è¿›å…¥FUN_000108d4å¤„ç†inputâ†’base64_magicå¤„ç†â†’è¿›å…¥FUN_00023c82è¿›è¡Œæ¯”è¾ƒ</p>
<p><img src="/2022/11/19/TEST/2.png"></p>
<p>è¿›å…¥FUN_000108d4å¯ä»¥çœ‹åˆ°ä¸‰ä¸ªforå¾ªç¯,åˆ†æä¸€ä¸‹,çœ‹æ³¨é‡Š(è¿™é‡Œå°±æ˜¯<strong>æœ‰é™åŸŸçŸ©é˜µä¹˜æ³•</strong>)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">FUN_000108d4</span><span class="params">(<span class="type">long</span> param_1)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  undefined8 enc1;</span><br><span class="line">  undefined8 local_48;</span><br><span class="line">  undefined8 local_40;</span><br><span class="line">  undefined local_38;</span><br><span class="line">  ulong k;</span><br><span class="line">  uint sum;</span><br><span class="line">  ulong j;</span><br><span class="line">  ulong i;</span><br><span class="line">  </span><br><span class="line">  enc1 = <span class="number">0</span>;</span><br><span class="line">  local_48 = <span class="number">0</span>;</span><br><span class="line">  local_40 = <span class="number">0</span>;</span><br><span class="line">  local_38 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i = i + <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">5</span>; j = j + <span class="number">1</span>) &#123;</span><br><span class="line">                      <span class="comment">/* é‡ç½®local_24 */</span></span><br><span class="line">      sum = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; <span class="number">5</span>; k = k + <span class="number">1</span>) &#123;</span><br><span class="line">                      <span class="comment">/* local_24 += fakekey[k+i*5]*a1[j+k*5] */</span></span><br><span class="line">         sum = (uint)*(byte *)(k + i * <span class="number">5</span> + <span class="number">0x7c000</span>) * (uint)*(byte *)(j + k * <span class="number">5</span> + param_1) + sum;</span><br><span class="line">      &#125;</span><br><span class="line">                      <span class="comment">/* local_50[j+i*5] = local_24 % 0x101 */</span></span><br><span class="line">      *(<span class="type">char</span> *)((<span class="type">long</span>)&amp;enc1 + j + i * <span class="number">5</span>) = (<span class="type">char</span>)(sum % <span class="number">0x101</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  FUN_000241f8(param_1,&amp;enc1,<span class="number">25</span>);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Hacking2-å¤åˆ¶"><a href="#Hacking2-å¤åˆ¶" class="headerlink" title="Hacking2-å¤åˆ¶"></a>Hacking2-å¤åˆ¶</h1><p>è¿›å…¥FUN_000241f8,è¿™é‡Œå¼€å§‹å°±å¾ˆä¹±äº†,ä¹Ÿæ˜¯åˆ†æçš„é‡ç‚¹,å¾ˆå¤šä»£ç æ— æ„ä¹‰è¿™æ—¶å€™åªèƒ½æ…¢æ…¢æ¥,ç»“åˆåŠ¨è°ƒ+æ±‡ç¼–+ä¼ªä»£ç æ¥åˆ†æ,ä½†æ˜¯ä¹‹é—´åŒä¸€æ®µä»£ç ç”¨çš„å˜é‡åˆä¸ä¸€æ ·,ä¸çŸ¥é“æ˜¯ä»€ä¹ˆåŸå› </p>
<p>åæ­£è·Ÿç€èµ°ä¸€éè¿‡ç¨‹,å°±å¯ä»¥å‘ç°æ¯æ¬¡ç¨‹åºéƒ½åªä¼šè¿›å…¥FUN_0002428c()(å› ä¸ºlenæŒ‡å®šå¥½æ˜¯25äº†),è€Œé‡Œé¢æ˜¯æŠŠenc1çš„æ•°æ®å¤åˆ¶åˆ°input(å¤åˆ¶çš„é•¿åº¦æ˜¯8çš„å€æ•°),å‰©ä¸‹æ²¡å¤åˆ¶çš„åœ¨æœ¬å‡½æ•°çš„æœ€åä¸€éƒ¨åˆ†ä¼šè¿›è¡Œå¤åˆ¶,è¯´ç™½äº†å°±æ˜¯å…¨éƒ¨å¤åˆ¶</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">undefined * <span class="title function_">FUN_000241f8</span><span class="params">(undefined *input,undefined *enc1,ulong len)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  ulong uVar3;</span><br><span class="line">  ulong uVar4;</span><br><span class="line">  undefined *puVar5;</span><br><span class="line">  undefined *input_p;</span><br><span class="line">  undefined *enc1_p;</span><br><span class="line">  undefined enc1_ch;</span><br><span class="line">  <span class="type">long</span> lVar2;</span><br><span class="line">  </span><br><span class="line">  input_p = input;</span><br><span class="line">  <span class="keyword">if</span> (<span class="number">0xf</span> &lt; len) &#123;</span><br><span class="line">                      <span class="comment">/* æœ‰ç‚¹å¥‡æ€ª,v4ç«Ÿç„¶æ˜¯æ‹¿åœ°å€å»%8çš„?? */</span></span><br><span class="line">    uVar4 = -(<span class="type">long</span>)input &amp; <span class="number">7</span>;</span><br><span class="line">    uVar3 = len - uVar4;</span><br><span class="line">                      <span class="comment">/* != 0 8 16 24 ... */</span></span><br><span class="line">    <span class="keyword">if</span> (uVar4 != <span class="number">0</span>) &#123;</span><br><span class="line">                      <span class="comment">/* encçš„å€¼å¤åˆ¶åˆ°input,èŒƒå›´æ˜¯[:?] */</span></span><br><span class="line">      enc1_p = enc1;</span><br><span class="line">      <span class="keyword">do</span> &#123;</span><br><span class="line">         enc1_ch = *enc1_p;</span><br><span class="line">                      <span class="comment">/* è‡ªåŠ ç”¨,ä¸ç®¡ */</span></span><br><span class="line">         puVar5 = input_p + <span class="number">1</span>;</span><br><span class="line">         enc1_p = enc1_p + <span class="number">1</span>;</span><br><span class="line">         *input_p = enc1_ch;</span><br><span class="line">         input_p = puVar5;</span><br><span class="line">      &#125; <span class="keyword">while</span> (input + uVar4 != puVar5);</span><br><span class="line">                      <span class="comment">/*   */</span></span><br><span class="line">      enc1 = enc1 + uVar4;</span><br><span class="line">      input_p = input + uVar4;</span><br><span class="line">    &#125;</span><br><span class="line">                      <span class="comment">/*    */</span></span><br><span class="line">    <span class="keyword">if</span> (((ulong)enc1 &amp; <span class="number">7</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">                      <span class="comment">/* è¿™é‡Œå’Œä¸‹é¢é‚£ä¸ªå‡½æ•°åº”è¯¥åç¼–è¯‘æœ‰ç‚¹é—®é¢˜,ä½†æ˜¯ä»–ä»¬çš„å‚æ•°æ˜¯ä¸€æ ·çš„*/</span></span><br><span class="line">      FUN_0002428c();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      FUN_00024370(input_p,enc1,uVar3 &gt;&gt; <span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">                      <span class="comment">/* enc1 += uVar3&amp;(-8),</span></span><br><span class="line"><span class="comment">                         enc1è‡ªåŠ çš„æ˜¯:æœ€å¤§çš„å°äºuVar3ä¸”å¯ä»¥æ•´é™¤8çš„æ•°</span></span><br><span class="line"><span class="comment">                         enc1æ›´æ–°</span></span><br><span class="line"><span class="comment">                          */</span></span><br><span class="line">    enc1 = enc1 + (uVar3 &amp; uVar1);</span><br><span class="line">                      <span class="comment">/* len = len % 8 */</span></span><br><span class="line">    len = uVar3 &amp; <span class="number">7</span>;</span><br><span class="line">                      <span class="comment">/* è¿™é‡Œå¾ˆå¥‡æ€ª,æ˜æ˜ç®—è¿‡æ˜¯+24çš„,ç»“æœåŠ çš„æ˜¯23=0x19 */</span></span><br><span class="line">    input_p = input_p + (uVar3 &amp; uVar1);</span><br><span class="line">  &#125;</span><br><span class="line">                      <span class="comment">/*  ç°åœ¨çš„enc1_pæ˜¯+24+1 */</span></span><br><span class="line">  enc1_p = enc1 + len;</span><br><span class="line">  lVar2 = <span class="number">-1</span> - (<span class="type">long</span>)enc1;</span><br><span class="line">                      <span class="comment">/* è¿˜æ²¡çœ‹æ‡‚è¿™é‡Œ */</span></span><br><span class="line">                      <span class="comment">/* å¤‡æ³¨ä¸€ä¸‹,å…¶å®è¿™ä¸€æ®µçš„ä»£ç åç¼–è¯‘çœŸçš„å¾ˆä¹±,çœ‹ç€æ„Ÿè§‰ä»£ç ä¹‹é—´æ²¡ä»€ä¹ˆæ„ä¹‰,æˆ‘æ˜¯ç»“åˆæ±‡ç¼–å’Œä¼ªä»£ç æ¥çœ‹çš„, è€Œä¸”ä¸¤è€…ä¹‹é—´åŒä¸€æ®µä»£ç ç”¨çš„å˜é‡åˆä¸ä¸€æ ·,ä¸çŸ¥é“æ˜¯ä»€ä¹ˆåŸå› </span></span><br><span class="line"><span class="comment">                         </span></span><br><span class="line"><span class="comment">                         è¿™ä¸€æ®µæ„Ÿè§‰å°±æ˜¯æŠŠå‰é¢æ²¡å¤åˆ¶å®Œçš„å¤åˆ¶è¿‡å»... */</span></span><br><span class="line">  <span class="keyword">if</span> (len != <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">                      <span class="comment">/* æ‹¿å‡ºæœ€åä¸€ä¸ªå€¼(æœ€åä¸€ä¸ªå°±æ˜¯è¿˜æ²¡æœ‰è¢«å¤åˆ¶çš„) */</span></span><br><span class="line">      enc1_ch = *enc1;</span><br><span class="line">      enc1 = enc1 + <span class="number">1</span>;</span><br><span class="line">      enc1[(<span class="type">long</span>)(input_p + lVar2)] = enc1_ch;</span><br><span class="line">    &#125; <span class="keyword">while</span> (enc1_p != enc1);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> input;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Hacking3-base64é­”æ”¹"><a href="#Hacking3-base64é­”æ”¹" class="headerlink" title="Hacking3-base64é­”æ”¹"></a>Hacking3-base64é­”æ”¹</h1><p>çœ‹åˆ°è¿™ä¸²ä¸œè¥¿åº”è¯¥å¾ˆæ˜æ˜¾äº†å§,åŒæ—¶æ³¨æ„åˆ°</p>
<ul>
<li>æœ‰æ¢è¡¨</li>
<li>3æ¢4ä¹‹åçš„å¼‚æˆ–æ“ä½œ(11h,22h,33h,44h)</li>
<li>å¡«å……ç¬¦ä¸ºâ€™hâ€™</li>
</ul>
<p>è¿™ä¸ªå°±å¥½é€†äº†,ä¸è¿‡ä¹‹å‰æƒ³å¤šäº†ä»¥ä¸ºå¼‚æˆ–æ“ä½œè¦åµŒå…¥base64è§£å¯†é‡Œé¢,å…¶å®å…ˆå¼‚æˆ–å°±å¾—åˆ°æ²¡æœ‰é­”æ”¹çš„å­—ç¬¦ä¸²äº†</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="title function_">base64_magic</span><span class="params">(<span class="type">long</span> param_1)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">long</span> len;</span><br><span class="line">  <span class="type">long</span> enc2;</span><br><span class="line">  <span class="type">int</span> local_20;</span><br><span class="line">  <span class="type">int</span> i;</span><br><span class="line">  <span class="type">long</span> final_len;</span><br><span class="line">  </span><br><span class="line">  len = ::len(param_1);</span><br><span class="line">  <span class="keyword">if</span> (len % <span class="number">3</span> == <span class="number">0</span>) &#123;</span><br><span class="line">    final_len = len / <span class="number">3</span> &lt;&lt; <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    final_len = (len / <span class="number">3</span> + <span class="number">1</span>) * <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">                      <span class="comment">/* ç”³è¯·ç©ºé—´? */</span></span><br><span class="line">  enc2 = FUN_00021fc6(final_len + <span class="number">1</span>);</span><br><span class="line">  *(undefined *)(final_len + enc2) = <span class="number">0</span>;</span><br><span class="line">  local_20 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; (<span class="type">long</span>)i &lt; final_len + <span class="number">-2</span>; i = i + <span class="number">4</span>) &#123;</span><br><span class="line">    *(byte *)(i + enc2) =</span><br><span class="line">          <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ9876543210+/&quot;</span></span><br><span class="line">          [(<span class="type">int</span>)(uint)(*(byte *)(local_20 + param_1) &gt;&gt; <span class="number">2</span>)] ^ <span class="number">0x11</span>;</span><br><span class="line">    *(byte *)((<span class="type">long</span>)i + <span class="number">1</span> + enc2) =</span><br><span class="line">          <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ9876543210+/&quot;</span></span><br><span class="line">          [(<span class="type">int</span>)((uint)(*(byte *)((<span class="type">long</span>)local_20 + <span class="number">1</span> + param_1) &gt;&gt; <span class="number">4</span>) |</span><br><span class="line">                (*(byte *)(local_20 + param_1) &amp; <span class="number">3</span>) &lt;&lt; <span class="number">4</span>)] ^ <span class="number">0x22</span>;</span><br><span class="line">    *(byte *)((<span class="type">long</span>)i + <span class="number">2</span> + enc2) =</span><br><span class="line">          <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ9876543210+/&quot;</span></span><br><span class="line">          [(<span class="type">int</span>)((uint)(*(byte *)((<span class="type">long</span>)local_20 + <span class="number">2</span> + param_1) &gt;&gt; <span class="number">6</span>) |</span><br><span class="line">                (*(byte *)((<span class="type">long</span>)local_20 + <span class="number">1</span> + param_1) &amp; <span class="number">0xf</span>) &lt;&lt; <span class="number">2</span>)] ^ <span class="number">0x33</span>;</span><br><span class="line">    *(byte *)((<span class="type">long</span>)i + <span class="number">3</span> + enc2) =</span><br><span class="line">          <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ9876543210+/&quot;</span></span><br><span class="line">          [(ulong)*(byte *)((<span class="type">long</span>)local_20 + <span class="number">2</span> + param_1) &amp; <span class="number">0x3f</span>] ^ <span class="number">0x44</span>;</span><br><span class="line">    local_20 = local_20 + <span class="number">3</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (len % <span class="number">3</span> == <span class="number">1</span>) &#123;</span><br><span class="line">    *(undefined *)((<span class="type">long</span>)i + <span class="number">-2</span> + enc2) = <span class="string">&#x27;h&#x27;</span>;</span><br><span class="line">    *(undefined *)((<span class="type">long</span>)i + <span class="number">-1</span> + enc2) = <span class="string">&#x27;h&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (len % <span class="number">3</span> == <span class="number">2</span>) &#123;</span><br><span class="line">    *(undefined *)((<span class="type">long</span>)i + <span class="number">-1</span> + enc2) = <span class="string">&#x27;h&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> enc2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h1><p>å†™è„šæœ¬æ—¶é—´~</p>
<p>ä»FUN_00023c82å¾—çŸ¥è¦æ¯”è¾ƒçš„æ˜¯,å› æ­¤å…ˆè¿›è¡Œbaseé­”æ”¹è§£å¯†,æ³¨æ„è§£å¯†ç»†èŠ‚(å¼‚æˆ–æ—¶ä¸è¦å¼‚æˆ–æ‰å¡«å……ç¬¦),å¾—åˆ°dec1</p>
<p><img src="/2022/11/19/TEST/3.png"></p>
<p><img src="/2022/11/19/TEST/4.png"></p>
<h3 id="çˆ†ç ´çŸ©é˜µ"><a href="#çˆ†ç ´çŸ©é˜µ" class="headerlink" title="çˆ†ç ´çŸ©é˜µ"></a>çˆ†ç ´çŸ©é˜µ</h3><p>è¿™æ¬¡æ—¶é—´ä¸»è¦èŠ±åœ¨äº†è§£çŸ©é˜µè¿™é‡Œ à®‡à¯°à®‡ æˆ‘åªæƒ³åˆ°äº†çº¿ä»£çš„åŸºæœ¬çŸ©é˜µä¹˜æ³•,ä½†æ˜¯ç»“æœæ˜¯è¢«æ¨¡é™¤è¿‡çš„,æ‰€ä»¥åªçŸ¥é“ä½™æ•°ä¸çŸ¥é“å•†,è¿™ç§æƒ…å†µä¸èƒ½ç®€å•çš„keyæ±‚é€†å†ä¹˜ä»¥dec1,z3ä¹Ÿè·‘ä¸å‡ºæ¥,è¿™æ—¶å€™å°±åªæœ‰æƒ³åˆ°çˆ†ç ´äº†</p>
<p>æ ¹æ®çŸ©é˜µä¹˜æ³•åŸç†,æ¯æ¬¡çˆ†ç ´inputçš„ä¸€åˆ—,ä½†æ˜¯æ—¶é—´æœ‰ä¸€ç‚¹ä¹…,ä¸€åˆ—å°±æ˜¯$(126-32)^4$, é‚£å°±çŒœä¸€ä¸‹,å‰é¢äº”ä¸ªå°±æ˜¯<code>flag&#123;</code>,æœ€åæ˜¯<code>&#125;</code> ,è¿™ä¹Ÿå°‘äº†ä¸€ä¸ªæ•°é‡çº§äº†</p>
<p>ç„¶åæ²¡æœ‰å†™å®Œæ•´çš„è„šæœ¬,åœ¨åŸºç¡€è„šæœ¬é‡Œé¢æ”¹jçš„å€¼å’Œaçš„å€¼å°±å¥½äº†</p>
<h3 id="æ­£è§„å†›åšæ³•"><a href="#æ­£è§„å†›åšæ³•" class="headerlink" title="æ­£è§„å†›åšæ³•"></a>æ­£è§„å†›åšæ³•</h3><p>è·Ÿå­¦é•¿äº¤æµæ‰çŸ¥é“è¿™ä¸ªå«æœ‰é™åŸŸçŸ©é˜µä¹˜æ³•,æœ‰é™åŸŸå°±æ˜¯0x101äº†,ä¸Šç½‘æŸ¥ç‚¹èµ„æ–™å°±èƒ½åš</p>
<h1 id="Getflag"><a href="#Getflag" class="headerlink" title="Getflag"></a>Getflag</h1><table>
<thead>
<tr>
<th>f</th>
<th>l</th>
<th>a</th>
<th>g</th>
<th>{</th>
</tr>
</thead>
<tbody><tr>
<td>f</td>
<td>o</td>
<td>r</td>
<td>_</td>
<td>t</td>
</tr>
<tr>
<td>h</td>
<td>e</td>
<td>_</td>
<td>1</td>
<td>i</td>
</tr>
<tr>
<td>c</td>
<td>h</td>
<td>_</td>
<td>k</td>
<td>i</td>
</tr>
<tr>
<td>n</td>
<td>g</td>
<td>!</td>
<td>!</td>
<td>}</td>
</tr>
</tbody></table>
<p>flag{for_the_1ich_king!!}</p>
<h1 id="ä¸€äº›å¤‡å¿˜"><a href="#ä¸€äº›å¤‡å¿˜" class="headerlink" title="ä¸€äº›å¤‡å¿˜"></a>ä¸€äº›å¤‡å¿˜</h1><p>input: 1234567891234567891234567</p>
<p><img src="/2022/11/19/TEST/5.png" alt="input 0x40007ffd80"></p>
<p>input 0x40007ffd80</p>
<p><img src="/2022/11/19/TEST/6.png" alt="enc1 0x40007ffd30"></p>
<p>enc1 0x40007ffd30</p>
<p>FUN_000241f8éœ€è¦æ³¨æ„:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">uVar4(a0)</span><br><span class="line">	uVar4 = -(long)input &amp; 7;</span><br><span class="line">	<span class="keyword">if</span> (uVar4 != 0)</span><br><span class="line">uVar3(s1)</span><br></pre></td></tr></table></figure>

<p>FUN_0002428c</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">value(a2)</span><br><span class="line">	switch(value &amp; 7)</span><br><span class="line">	æ›´æ–°</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/11/19/TEST/" data-id="clazauqqf0002achxb2qa6ckd" data-title="XSCTFå†³èµ›-é˜²AK-writeup" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Hello-World-0" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/09/18/Hello-World-0/" class="article-date">
  <time class="dt-published" datetime="2022-09-18T14:53:02.000Z" itemprop="datePublished">2022-09-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/09/18/Hello-World-0/">Hello World!</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Hello, everone! This is Hur1k! æ¬¢è¿å…‰ä¸´æˆ‘çš„å°ç ´ç«™ï¼</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/09/18/Hello-World-0/" data-id="clazauqqd0001achx7leubkaa" data-title="Hello World!" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-hello-world" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/09/18/hello-world/" class="article-date">
  <time class="dt-published" datetime="2022-09-18T14:42:45.867Z" itemprop="datePublished">2022-09-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/09/18/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/09/18/hello-world/" data-id="clazauqqa0000achxdm7f7ou9" data-title="Hello World" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">November 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/11/19/TEST/">XSCTFå†³èµ›-é˜²AK-writeup</a>
          </li>
        
          <li>
            <a href="/2022/09/18/Hello-World-0/">Hello World!</a>
          </li>
        
          <li>
            <a href="/2022/09/18/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 Hur1k<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>