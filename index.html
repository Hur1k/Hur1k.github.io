<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>(施工中...闲人免进...)Hur1k的小小窝啊( •̀ ω •́ )✧</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="(施工中...闲人免进...)热乎着呢,快来坐坐~">
<meta property="og:type" content="website">
<meta property="og:title" content="(施工中...闲人免进...)Hur1k的小小窝啊( •̀ ω •́ )✧">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="(施工中...闲人免进...)Hur1k的小小窝啊( •̀ ω •́ )✧">
<meta property="og:description" content="(施工中...闲人免进...)热乎着呢,快来坐坐~">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Hur1k">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="(施工中...闲人免进...)Hur1k的小小窝啊( •̀ ω •́ )✧" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">(施工中...闲人免进...)Hur1k的小小窝啊( •̀ ω •́ )✧</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-XSCTF决赛-防AK-writeup" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/" class="article-date">
  <time class="dt-published" datetime="2022-11-18T16:47:44.000Z" itemprop="datePublished">2022-11-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/">XSCTF决赛-防AK-writeup</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>第一篇WP (╹ڡ╹ )</p>
<p>从决赛到现在大概是2周的时间,终于算是做完了😭</p>
<p>Ghidra竟然能打开!!虽然反编译层也是有点难,做完后发现其实加密操作不算难,只是架构问题把很多操作都复杂化了</p>
<p>虽然花的时间比较久,但总的来说收获还是挺大的,以前一直依赖着贵妇头的动调工具,很少用到只有反汇编没有反编译的工具如gdb(gdb都不会用!该打!),另外也练习了一下矩阵类的题目,相关库(numpy,sympy)的使用,继续加油~</p>
<h1 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#爆破脚本</span></span><br><span class="line"></span><br><span class="line">enc = [<span class="number">0x23</span>, <span class="number">0x58</span>, <span class="number">0x64</span>, <span class="number">0x0c</span>, <span class="number">0x3a</span>, <span class="number">0x6a</span>, <span class="number">0x7c</span>, <span class="number">0x09</span>, <span class="number">0x65</span>, <span class="number">0x65</span>, <span class="number">0x02</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x7a</span>, <span class="number">0x4a</span>, <span class="number">0x10</span>, <span class="number">0x3e</span>, <span class="number">0x1a</span>, <span class="number">0x45</span>, <span class="number">0x01</span>,</span><br><span class="line">    <span class="number">0x3a</span>, <span class="number">0x09</span>, <span class="number">0x02</span>, <span class="number">0x72</span>, <span class="number">0x3e</span>, <span class="number">0x15</span>, <span class="number">0x74</span>, <span class="number">0x0b</span>, <span class="number">0x25</span>, <span class="number">0x55</span>, <span class="number">0x03</span>, <span class="number">0x35</span>, <span class="number">0x60</span>, <span class="number">0x75</span>, <span class="number">0x68</span>, <span class="number">0x68</span>]</span><br><span class="line">xor_list=[<span class="number">0x11</span>,<span class="number">0x22</span>,<span class="number">0x33</span>,<span class="number">0x44</span>]</span><br><span class="line">fakekey=<span class="string">&#x27;flag&#123;No!I_am_not_the_key&#125;&#x27;</span></span><br><span class="line">fakekey=<span class="built_in">list</span>(fakekey.encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">b64Magic</span>(<span class="params">magicDic,plaintext</span>):</span><br><span class="line">    <span class="keyword">import</span> base64</span><br><span class="line">    str1=plaintext</span><br><span class="line">    string1=magicDic</span><br><span class="line">    string2 = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">    <span class="built_in">print</span> (base64.b64decode(str1.translate(<span class="built_in">str</span>.maketrans(string1,string2))))</span><br><span class="line">    <span class="keyword">return</span> base64.b64decode(str1.translate(<span class="built_in">str</span>.maketrans(string1,string2)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix_line_mul</span>(<span class="params">line,i</span>):</span><br><span class="line">    tmp=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        tmp+=(fakekey[k+i*<span class="number">5</span>]*line[k])</span><br><span class="line">    <span class="keyword">return</span> tmp%<span class="number">0x101</span></span><br><span class="line">            </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)-<span class="number">2</span>):</span><br><span class="line">        enc[i]^=xor_list[i%<span class="number">4</span>]</span><br><span class="line">    enc[-<span class="number">1</span>]=<span class="built_in">ord</span>(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">    enc[-<span class="number">2</span>]=<span class="built_in">ord</span>(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytes</span>(enc))</span><br><span class="line">    magicDic=<span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ9876543210+/&#x27;</span></span><br><span class="line">    dec1=<span class="built_in">list</span>(b64Magic(magicDic,<span class="built_in">bytes</span>(enc).decode()))</span><br><span class="line">    </span><br><span class="line">    ans=[]</span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">    j=<span class="number">2</span> <span class="comment">#改这</span></span><br><span class="line">    a=<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) <span class="comment">#改这</span></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">            <span class="keyword">if</span> c%<span class="number">10</span>==<span class="number">0</span>: <span class="comment">#监视进度(安全感)</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;b:<span class="subst">&#123;<span class="built_in">chr</span>(b)&#125;</span> c:<span class="subst">&#123;<span class="built_in">chr</span>(c)&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">                <span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">126</span>):</span><br><span class="line">                    data=[a,b,c,d,e]</span><br><span class="line">                    <span class="comment"># print(matrix_line_mul(data,0))</span></span><br><span class="line">                    <span class="keyword">if</span> matrix_line_mul(data,<span class="number">0</span>) == dec1[<span class="number">0</span>*<span class="number">5</span>+j]:</span><br><span class="line">                        <span class="keyword">if</span> matrix_line_mul(data,<span class="number">1</span>) == dec1[<span class="number">1</span>*<span class="number">5</span>+j]:</span><br><span class="line">                            <span class="keyword">if</span> matrix_line_mul(data,<span class="number">2</span>) == dec1[<span class="number">2</span>*<span class="number">5</span>+j]:</span><br><span class="line">                                <span class="keyword">if</span> matrix_line_mul(data,<span class="number">3</span>) == dec1[<span class="number">3</span>*<span class="number">5</span>+j]:</span><br><span class="line">                                    <span class="keyword">if</span> matrix_line_mul(data,<span class="number">4</span>) == dec1[<span class="number">4</span>*<span class="number">5</span>+j]:</span><br><span class="line">                                        <span class="built_in">print</span>(<span class="string">f&quot;Found! <span class="subst">&#123;data&#125;</span> <span class="subst">&#123;<span class="built_in">bytes</span>(data)&#125;</span>&quot;</span>)</span><br><span class="line">                                        <span class="built_in">breakpoint</span>()</span><br><span class="line">                                        ans.append(data)</span><br><span class="line">    <span class="built_in">print</span>(ans)</span><br><span class="line">main()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#正规军脚本,用到了sympy</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line">np.set_printoptions(suppress=<span class="literal">True</span>) <span class="comment">#不使用科学计数法</span></span><br><span class="line"></span><br><span class="line">enc = [<span class="number">0x23</span>, <span class="number">0x58</span>, <span class="number">0x64</span>, <span class="number">0x0c</span>, <span class="number">0x3a</span>, <span class="number">0x6a</span>, <span class="number">0x7c</span>, <span class="number">0x09</span>, <span class="number">0x65</span>, <span class="number">0x65</span>, <span class="number">0x02</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x7a</span>, <span class="number">0x4a</span>, <span class="number">0x10</span>, <span class="number">0x3e</span>, <span class="number">0x1a</span>, <span class="number">0x45</span>, <span class="number">0x01</span>,</span><br><span class="line">    <span class="number">0x3a</span>, <span class="number">0x09</span>, <span class="number">0x02</span>, <span class="number">0x72</span>, <span class="number">0x3e</span>, <span class="number">0x15</span>, <span class="number">0x74</span>, <span class="number">0x0b</span>, <span class="number">0x25</span>, <span class="number">0x55</span>, <span class="number">0x03</span>, <span class="number">0x35</span>, <span class="number">0x60</span>, <span class="number">0x75</span>, <span class="number">0x68</span>, <span class="number">0x68</span>]</span><br><span class="line">xor_list=[<span class="number">0x11</span>,<span class="number">0x22</span>,<span class="number">0x33</span>,<span class="number">0x44</span>]</span><br><span class="line"></span><br><span class="line">enc1=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">b64Magic</span>(<span class="params">magicDic,plaintext</span>):</span><br><span class="line">    <span class="keyword">import</span> base64</span><br><span class="line">    str1=plaintext</span><br><span class="line">    string1=magicDic</span><br><span class="line">    string2 = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">    <span class="built_in">print</span> (base64.b64decode(str1.translate(<span class="built_in">str</span>.maketrans(string1,string2))))</span><br><span class="line">    <span class="keyword">return</span> base64.b64decode(str1.translate(<span class="built_in">str</span>.maketrans(string1,string2)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    fakekey=<span class="string">&#x27;flag&#123;No!I_am_not_the_key&#125;&#x27;</span></span><br><span class="line">    fakekey=<span class="built_in">list</span>(fakekey.encode())</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)-<span class="number">2</span>):</span><br><span class="line">        enc[i]^=xor_list[i%<span class="number">4</span>]</span><br><span class="line">    enc[-<span class="number">1</span>]=<span class="built_in">ord</span>(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">    enc[-<span class="number">2</span>]=<span class="built_in">ord</span>(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytes</span>(enc))</span><br><span class="line">    magicDic=<span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ9876543210+/&#x27;</span></span><br><span class="line">    dec1=<span class="built_in">list</span>(b64Magic(magicDic,<span class="built_in">bytes</span>(enc).decode()))</span><br><span class="line">   </span><br><span class="line">    fakekey=sympy.Matrix(fakekey).reshape(<span class="number">5</span>,<span class="number">5</span>)</span><br><span class="line">    dec1=sympy.Matrix(dec1).reshape(<span class="number">5</span>,<span class="number">5</span>)</span><br><span class="line">    fakekey_inv=fakekey.inv_mod(<span class="number">0x101</span>)</span><br><span class="line">    flag=fakekey_inv*dec1%<span class="number">0x101</span></span><br><span class="line">    sympy.pprint(flag)</span><br><span class="line">main()</span><br></pre></td></tr></table></figure>

<h1 id="省流"><a href="#省流" class="headerlink" title="省流"></a>省流</h1><p>有限域矩阵乘法+复制操作+base64魔改(换表+异或)</p>
<h1 id="一些积累"><a href="#一些积累" class="headerlink" title="一些积累"></a>一些积累</h1><p><code>x &amp; p</code> 其中p为形如0b1, 0b11, 0b111,那么效果相当于<code>x % (p+1)</code></p>
<h3 id="Riscv寄存器"><a href="#Riscv寄存器" class="headerlink" title="Riscv寄存器"></a>Riscv寄存器</h3><p>另外注意riscv和i386的不同</p>
<p><code>x8/s0/fp</code> saved register 、frame pointer</p>
<p><code>x10 / a0</code> (function argument, return value)</p>
<p><code>x11 / a1</code>(function argument, return value)</p>
<p><code>x18 / s2</code> (saved register)</p>
<ul>
<li><p>寄存器</p>
<p>  <img src="/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/1.png"></p>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://lab.cs.tsinghua.edu.cn/cod-lab-docs/labs/4-riscv-inst/">RISC-V 指令概况</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/George-Okelly1995/p/9801357.html">[计算机硬件] RISC-V 汇编指令笔记</a></p>
<p>感觉更全一点</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/558799873">计基(二)RISC-V指令集介绍与汇编</a></p>
<h1 id="运行-动调"><a href="#运行-动调" class="headerlink" title="运行+动调"></a>运行+动调</h1><blockquote>
<p>总结了一下不同架构的运行加动调方法,特别感谢大佬stdlibh教我配环境😭</p>
</blockquote>
<h2 id="相关工具"><a href="#相关工具" class="headerlink" title="相关工具"></a>相关工具</h2><blockquote>
<p>只是列举了一下,实际上没用到那么多</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install qemu qemu-user qemu-user-static gdb gdb-multiarch <span class="string">&#x27;binfmt*&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>qemu系统态</li>
<li>qemu-user-static用户态(static不知道啥)</li>
<li>gdb</li>
<li>gdb-multiarch</li>
<li>binfmt可以使用该包查看文件的类型,并自动调用正确的解释器.</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装gdb插件pwndbg(或者gef等支持多架构的插件)</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/pwndbg/pwndbg</span><br><span class="line"><span class="built_in">cd</span> pwndbg</span><br><span class="line">./setup.sh</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装riscv-gnu-toolchain</span></span><br><span class="line"><span class="comment"># https://github.com/riscv-collab/riscv-gnu-toolchain</span></span><br><span class="line"><span class="comment"># 直接在Release中找对应的压缩包下载即可</span></span><br><span class="line">riscv64-elf-ubuntu-20.04-nightly-2022.11.12-nightly.tar.gz</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="静态链接运行"><a href="#静态链接运行" class="headerlink" title="静态链接运行"></a>静态链接运行</h2><h3 id="方法1"><a href="#方法1" class="headerlink" title="方法1"></a>方法1</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">file ./arch</span><br><span class="line">./arch</span><br></pre></td></tr></table></figure>

<ul>
<li><p>先file查看文件类型,这里arch是文件名,以及链接方法</p>
</li>
<li><p>这时候可以直接运行</p>
<p>  原因(<a target="_blank" rel="noopener" href="https://danielmangum.com/posts/risc-v-bytes-qemu-gdb/">参考</a>):linux内核支持一个特性:binfmt_misc, 允许为指定的二进制类型自动注册和调用解释器,安装了qemu后它就可以用了,可以<code>ls /proc/sys/fs/binfmt_misc/</code> 查看详情</p>
</li>
</ul>
<h3 id="方法2-参考"><a href="#方法2-参考" class="headerlink" title="方法2(参考)"></a>方法2(<a target="_blank" rel="noopener" href="https://blog.csdn.net/Homewm/article/details/103574535">参考</a>)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> /usr/bin/qemu-riscv-static ./</span><br><span class="line">sudo <span class="built_in">chroot</span> . ./qemu-riscv-static ./arch</span><br></pre></td></tr></table></figure>

<ul>
<li>cp也可以写为<code>cp which qemu-mips-static ./</code></li>
<li><code>sudo chroot .</code>  可以不写</li>
<li>这种属于直接把相应的运行器拉出来使用</li>
</ul>
<h2 id="动态链接运行-还没试过"><a href="#动态链接运行-还没试过" class="headerlink" title="动态链接运行(还没试过)"></a>动态链接运行(还没试过)</h2><h3 id="安装共享库-参考"><a href="#安装共享库-参考" class="headerlink" title="安装共享库(参考)"></a>安装共享库(<a target="_blank" rel="noopener" href="https://www.cnblogs.com/WangAoBo/p/debug-arm-mips-on-linux.html">参考</a>)</h3><p><code>apt-cache search &quot;libc6&quot; | grep riscv</code></p>
<p>然后安装对应的库即可</p>
<h3 id="指定共享库"><a href="#指定共享库" class="headerlink" title="指定共享库"></a>指定共享库</h3><p><code>qemu-mipsel -L /usr/mipsel-linux-gnu/ ./arch</code></p>
<ul>
<li>注意:仅为示例代码</li>
<li>第一个是运行器,-L指定共享库</li>
</ul>
<h2 id="动态调试"><a href="#动态调试" class="headerlink" title="动态调试"></a>动态调试</h2><h3 id="尝试一"><a href="#尝试一" class="headerlink" title="尝试一"></a>尝试一</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">qemu-mipsel -g 1234 -L /usr/mipsel-linux-gnu/ ./arch</span><br><span class="line">gdb-multiarch</span><br><span class="line"><span class="built_in">set</span> architecture mips</span><br><span class="line">target remote localhost:1234</span><br></pre></td></tr></table></figure>

<ul>
<li>示例代码,-g指定端口</li>
<li>使用gdb-multiarch进行调试,设置好架构(tab查看详情,也可以设置为auto)</li>
<li>指定调试的目标端口位置</li>
<li><strong>然后这道题我用这个方法不成功</strong></li>
</ul>
<h3 id="尝试二"><a href="#尝试二" class="headerlink" title="尝试二"></a>尝试二</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo qemu-riscv64 -g 9999 <span class="built_in">arch</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo ./riscv64-unknown-elf-gdb</span><br><span class="line">file <span class="built_in">arch</span>     <span class="comment">#(No debugging symbols found in arch)</span></span><br><span class="line">targe remote :9999</span><br></pre></td></tr></table></figure>

<ul>
<li>一个窗口开gdbserver,一个控制gdb</li>
<li><strong>sudo要加上,不知道为啥我不加就动调不了</strong></li>
<li>在bash中file的时候说<strong>stripped</strong>,所以没有符号信息,这时候gdb只能控制continue,不能直接下断点,单步操作等,所以调试变得非常麻烦,当时只能给地址下断点如<code>b *0x10dbe</code> ,<strong>但是我觉得这种情况应该还是可以单步调试的,希望有大佬能解答一下方法</strong></li>
</ul>
<p>然后就可以愉快的做题啦😝</p>
<h1 id="Hacking1-有限域矩阵乘法"><a href="#Hacking1-有限域矩阵乘法" class="headerlink" title="Hacking1-有限域矩阵乘法"></a>Hacking1-有限域矩阵乘法</h1><p>一开始一直在纠结IDA怎么打开,打开后又不能动调不能反编译,后面折腾环境去了,决赛结束</p>
<p>经提点用Ghidra打开,发现新世界😭</p>
<p>先看main_func的逻辑:获取输入→进入FUN_000108d4处理input→base64_magic处理→进入FUN_00023c82进行比较</p>
<p><img src="/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/2.png"></p>
<p>进入FUN_000108d4可以看到三个for循环,分析一下,看注释(这里就是<strong>有限域矩阵乘法</strong>)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">FUN_000108d4</span><span class="params">(<span class="type">long</span> param_1)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  undefined8 enc1;</span><br><span class="line">  undefined8 local_48;</span><br><span class="line">  undefined8 local_40;</span><br><span class="line">  undefined local_38;</span><br><span class="line">  ulong k;</span><br><span class="line">  uint sum;</span><br><span class="line">  ulong j;</span><br><span class="line">  ulong i;</span><br><span class="line">  </span><br><span class="line">  enc1 = <span class="number">0</span>;</span><br><span class="line">  local_48 = <span class="number">0</span>;</span><br><span class="line">  local_40 = <span class="number">0</span>;</span><br><span class="line">  local_38 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i = i + <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">5</span>; j = j + <span class="number">1</span>) &#123;</span><br><span class="line">                      <span class="comment">/* 重置local_24 */</span></span><br><span class="line">      sum = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; <span class="number">5</span>; k = k + <span class="number">1</span>) &#123;</span><br><span class="line">                      <span class="comment">/* local_24 += fakekey[k+i*5]*a1[j+k*5] */</span></span><br><span class="line">         sum = (uint)*(byte *)(k + i * <span class="number">5</span> + <span class="number">0x7c000</span>) * (uint)*(byte *)(j + k * <span class="number">5</span> + param_1) + sum;</span><br><span class="line">      &#125;</span><br><span class="line">                      <span class="comment">/* local_50[j+i*5] = local_24 % 0x101 */</span></span><br><span class="line">      *(<span class="type">char</span> *)((<span class="type">long</span>)&amp;enc1 + j + i * <span class="number">5</span>) = (<span class="type">char</span>)(sum % <span class="number">0x101</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  FUN_000241f8(param_1,&amp;enc1,<span class="number">25</span>);</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Hacking2-复制"><a href="#Hacking2-复制" class="headerlink" title="Hacking2-复制"></a>Hacking2-复制</h1><p>进入FUN_000241f8,这里开始就很乱了,也是分析的重点,很多代码无意义这时候只能慢慢来,结合动调+汇编+伪代码来分析,但是之间同一段代码用的变量又不一样,不知道是什么原因</p>
<p>反正跟着走一遍过程,就可以发现每次程序都只会进入FUN_0002428c()(因为len指定好是25了),而里面是把enc1的数据复制到input(复制的长度是8的倍数),剩下没复制的在本函数的最后一部分会进行复制,说白了就是全部复制</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">undefined * <span class="title function_">FUN_000241f8</span><span class="params">(undefined *input,undefined *enc1,ulong len)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  ulong uVar3;</span><br><span class="line">  ulong uVar4;</span><br><span class="line">  undefined *puVar5;</span><br><span class="line">  undefined *input_p;</span><br><span class="line">  undefined *enc1_p;</span><br><span class="line">  undefined enc1_ch;</span><br><span class="line">  <span class="type">long</span> lVar2;</span><br><span class="line">  </span><br><span class="line">  input_p = input;</span><br><span class="line">  <span class="keyword">if</span> (<span class="number">0xf</span> &lt; len) &#123;</span><br><span class="line">                      <span class="comment">/* 有点奇怪,v4竟然是拿地址去%8的?? */</span></span><br><span class="line">    uVar4 = -(<span class="type">long</span>)input &amp; <span class="number">7</span>;</span><br><span class="line">    uVar3 = len - uVar4;</span><br><span class="line">                      <span class="comment">/* != 0 8 16 24 ... */</span></span><br><span class="line">    <span class="keyword">if</span> (uVar4 != <span class="number">0</span>) &#123;</span><br><span class="line">                      <span class="comment">/* enc的值复制到input,范围是[:?] */</span></span><br><span class="line">      enc1_p = enc1;</span><br><span class="line">      <span class="keyword">do</span> &#123;</span><br><span class="line">         enc1_ch = *enc1_p;</span><br><span class="line">                      <span class="comment">/* 自加用,不管 */</span></span><br><span class="line">         puVar5 = input_p + <span class="number">1</span>;</span><br><span class="line">         enc1_p = enc1_p + <span class="number">1</span>;</span><br><span class="line">         *input_p = enc1_ch;</span><br><span class="line">         input_p = puVar5;</span><br><span class="line">      &#125; <span class="keyword">while</span> (input + uVar4 != puVar5);</span><br><span class="line">                      <span class="comment">/*   */</span></span><br><span class="line">      enc1 = enc1 + uVar4;</span><br><span class="line">      input_p = input + uVar4;</span><br><span class="line">    &#125;</span><br><span class="line">                      <span class="comment">/*    */</span></span><br><span class="line">    <span class="keyword">if</span> (((ulong)enc1 &amp; <span class="number">7</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">                      <span class="comment">/* 这里和下面那个函数应该反编译有点问题,但是他们的参数是一样的*/</span></span><br><span class="line">      FUN_0002428c();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      FUN_00024370(input_p,enc1,uVar3 &gt;&gt; <span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">                      <span class="comment">/* enc1 += uVar3&amp;(-8),</span></span><br><span class="line"><span class="comment">                         enc1自加的是:最大的小于uVar3且可以整除8的数</span></span><br><span class="line"><span class="comment">                         enc1更新</span></span><br><span class="line"><span class="comment">                          */</span></span><br><span class="line">    enc1 = enc1 + (uVar3 &amp; uVar1);</span><br><span class="line">                      <span class="comment">/* len = len % 8 */</span></span><br><span class="line">    len = uVar3 &amp; <span class="number">7</span>;</span><br><span class="line">                      <span class="comment">/* 这里很奇怪,明明算过是+24的,结果加的是23=0x19 */</span></span><br><span class="line">    input_p = input_p + (uVar3 &amp; uVar1);</span><br><span class="line">  &#125;</span><br><span class="line">                      <span class="comment">/*  现在的enc1_p是+24+1 */</span></span><br><span class="line">  enc1_p = enc1 + len;</span><br><span class="line">  lVar2 = <span class="number">-1</span> - (<span class="type">long</span>)enc1;</span><br><span class="line">                      <span class="comment">/* 还没看懂这里 */</span></span><br><span class="line">                      <span class="comment">/* 备注一下,其实这一段的代码反编译真的很乱,看着感觉代码之间没什么意义,我是结合汇编和伪代码来看的, 而且两者之间同一段代码用的变量又不一样,不知道是什么原因</span></span><br><span class="line"><span class="comment">                         </span></span><br><span class="line"><span class="comment">                         这一段感觉就是把前面没复制完的复制过去... */</span></span><br><span class="line">  <span class="keyword">if</span> (len != <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">                      <span class="comment">/* 拿出最后一个值(最后一个就是还没有被复制的) */</span></span><br><span class="line">      enc1_ch = *enc1;</span><br><span class="line">      enc1 = enc1 + <span class="number">1</span>;</span><br><span class="line">      enc1[(<span class="type">long</span>)(input_p + lVar2)] = enc1_ch;</span><br><span class="line">    &#125; <span class="keyword">while</span> (enc1_p != enc1);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> input;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Hacking3-base64魔改"><a href="#Hacking3-base64魔改" class="headerlink" title="Hacking3-base64魔改"></a>Hacking3-base64魔改</h1><p>看到这串东西应该很明显了吧,同时注意到</p>
<ul>
<li>有换表</li>
<li>3换4之后的异或操作(11h,22h,33h,44h)</li>
<li>填充符为’h’</li>
</ul>
<p>这个就好逆了,不过之前想多了以为异或操作要嵌入base64解密里面,其实先异或就得到没有魔改的字符串了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="title function_">base64_magic</span><span class="params">(<span class="type">long</span> param_1)</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">long</span> len;</span><br><span class="line">  <span class="type">long</span> enc2;</span><br><span class="line">  <span class="type">int</span> local_20;</span><br><span class="line">  <span class="type">int</span> i;</span><br><span class="line">  <span class="type">long</span> final_len;</span><br><span class="line">  </span><br><span class="line">  len = ::len(param_1);</span><br><span class="line">  <span class="keyword">if</span> (len % <span class="number">3</span> == <span class="number">0</span>) &#123;</span><br><span class="line">    final_len = len / <span class="number">3</span> &lt;&lt; <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    final_len = (len / <span class="number">3</span> + <span class="number">1</span>) * <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">                      <span class="comment">/* 申请空间? */</span></span><br><span class="line">  enc2 = FUN_00021fc6(final_len + <span class="number">1</span>);</span><br><span class="line">  *(undefined *)(final_len + enc2) = <span class="number">0</span>;</span><br><span class="line">  local_20 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; (<span class="type">long</span>)i &lt; final_len + <span class="number">-2</span>; i = i + <span class="number">4</span>) &#123;</span><br><span class="line">    *(byte *)(i + enc2) =</span><br><span class="line">          <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ9876543210+/&quot;</span></span><br><span class="line">          [(<span class="type">int</span>)(uint)(*(byte *)(local_20 + param_1) &gt;&gt; <span class="number">2</span>)] ^ <span class="number">0x11</span>;</span><br><span class="line">    *(byte *)((<span class="type">long</span>)i + <span class="number">1</span> + enc2) =</span><br><span class="line">          <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ9876543210+/&quot;</span></span><br><span class="line">          [(<span class="type">int</span>)((uint)(*(byte *)((<span class="type">long</span>)local_20 + <span class="number">1</span> + param_1) &gt;&gt; <span class="number">4</span>) |</span><br><span class="line">                (*(byte *)(local_20 + param_1) &amp; <span class="number">3</span>) &lt;&lt; <span class="number">4</span>)] ^ <span class="number">0x22</span>;</span><br><span class="line">    *(byte *)((<span class="type">long</span>)i + <span class="number">2</span> + enc2) =</span><br><span class="line">          <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ9876543210+/&quot;</span></span><br><span class="line">          [(<span class="type">int</span>)((uint)(*(byte *)((<span class="type">long</span>)local_20 + <span class="number">2</span> + param_1) &gt;&gt; <span class="number">6</span>) |</span><br><span class="line">                (*(byte *)((<span class="type">long</span>)local_20 + <span class="number">1</span> + param_1) &amp; <span class="number">0xf</span>) &lt;&lt; <span class="number">2</span>)] ^ <span class="number">0x33</span>;</span><br><span class="line">    *(byte *)((<span class="type">long</span>)i + <span class="number">3</span> + enc2) =</span><br><span class="line">          <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ9876543210+/&quot;</span></span><br><span class="line">          [(ulong)*(byte *)((<span class="type">long</span>)local_20 + <span class="number">2</span> + param_1) &amp; <span class="number">0x3f</span>] ^ <span class="number">0x44</span>;</span><br><span class="line">    local_20 = local_20 + <span class="number">3</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (len % <span class="number">3</span> == <span class="number">1</span>) &#123;</span><br><span class="line">    *(undefined *)((<span class="type">long</span>)i + <span class="number">-2</span> + enc2) = <span class="string">&#x27;h&#x27;</span>;</span><br><span class="line">    *(undefined *)((<span class="type">long</span>)i + <span class="number">-1</span> + enc2) = <span class="string">&#x27;h&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (len % <span class="number">3</span> == <span class="number">2</span>) &#123;</span><br><span class="line">    *(undefined *)((<span class="type">long</span>)i + <span class="number">-1</span> + enc2) = <span class="string">&#x27;h&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> enc2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h1><p>写脚本时间~</p>
<p>从FUN_00023c82得知要比较的是,因此先进行base魔改解密,注意解密细节(异或时不要异或掉填充符),得到dec1</p>
<p><img src="/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/3.png"></p>
<p><img src="/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/4.png"></p>
<h3 id="爆破矩阵"><a href="#爆破矩阵" class="headerlink" title="爆破矩阵"></a>爆破矩阵</h3><p>这次时间主要花在了解矩阵这里 இ௰இ 我只想到了线代的基本矩阵乘法,但是结果是被模除过的,所以只知道余数不知道商,这种情况不能简单的key求逆再乘以dec1,z3也跑不出来,这时候就只有想到爆破了</p>
<p>根据矩阵乘法原理,每次爆破input的一列,但是时间有一点久,一列就是$(126-32)^4$, 那就猜一下,前面五个就是<code>flag&#123;</code>,最后是<code>&#125;</code> ,这也少了一个数量级了</p>
<p>然后没有写完整的脚本,在基础脚本里面改j的值和a的值就好了</p>
<h3 id="正规军做法"><a href="#正规军做法" class="headerlink" title="正规军做法"></a>正规军做法</h3><p>跟学长交流才知道这个叫有限域矩阵乘法,有限域就是0x101了,上网查点资料就能做</p>
<h1 id="Getflag"><a href="#Getflag" class="headerlink" title="Getflag"></a>Getflag</h1><table>
<thead>
<tr>
<th>f</th>
<th>l</th>
<th>a</th>
<th>g</th>
<th>{</th>
</tr>
</thead>
<tbody><tr>
<td>f</td>
<td>o</td>
<td>r</td>
<td>_</td>
<td>t</td>
</tr>
<tr>
<td>h</td>
<td>e</td>
<td>_</td>
<td>1</td>
<td>i</td>
</tr>
<tr>
<td>c</td>
<td>h</td>
<td>_</td>
<td>k</td>
<td>i</td>
</tr>
<tr>
<td>n</td>
<td>g</td>
<td>!</td>
<td>!</td>
<td>}</td>
</tr>
</tbody></table>
<p>flag{for_the_1ich_king!!}</p>
<h1 id="一些备忘"><a href="#一些备忘" class="headerlink" title="一些备忘"></a>一些备忘</h1><p>input: 1234567891234567891234567</p>
<p><img src="/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/5.png" alt="input 0x40007ffd80"></p>
<p>input 0x40007ffd80</p>
<p><img src="/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/6.png" alt="enc1 0x40007ffd30"></p>
<p>enc1 0x40007ffd30</p>
<p>FUN_000241f8需要注意:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">uVar4(a0)</span><br><span class="line">	uVar4 = -(long)input &amp; 7;</span><br><span class="line">	<span class="keyword">if</span> (uVar4 != 0)</span><br><span class="line">uVar3(s1)</span><br></pre></td></tr></table></figure>

<p>FUN_0002428c</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">value(a2)</span><br><span class="line">	switch(value &amp; 7)</span><br><span class="line">	更新</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/" data-id="clazb7ib7000280hx78qkg3c6" data-title="XSCTF决赛-防AK-writeup" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Hello-World-0" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/09/18/Hello-World-0/" class="article-date">
  <time class="dt-published" datetime="2022-09-18T14:53:02.000Z" itemprop="datePublished">2022-09-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/09/18/Hello-World-0/">Hello World!</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Hello, everone! This is Hur1k! 欢迎光临我的小破站！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/09/18/Hello-World-0/" data-id="clazb7ib1000080hx9f9odlg2" data-title="Hello World!" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-hello-world" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/09/18/hello-world/" class="article-date">
  <time class="dt-published" datetime="2022-09-18T14:42:45.867Z" itemprop="datePublished">2022-09-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/09/18/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/09/18/hello-world/" data-id="clazb7ib5000180hx1hrc9e9g" data-title="Hello World" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">November 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/11/19/XSCTF%E5%86%B3%E8%B5%9B-%E9%98%B2AK-writeup/">XSCTF决赛-防AK-writeup</a>
          </li>
        
          <li>
            <a href="/2022/09/18/Hello-World-0/">Hello World!</a>
          </li>
        
          <li>
            <a href="/2022/09/18/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 Hur1k<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>